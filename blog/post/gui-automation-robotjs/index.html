<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> GUI Automation with RobotJS - Nan Xiao | 肖楠 </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="In this post, I use RobotJS to implement a simple GUI automation workflow that updates a browser extension from a Git repository.
" />

    
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="Nan Xiao | 肖楠" />
    <meta property="og:url" content="https://nanx.me/blog/post/gui-automation-robotjs/" />
    <meta property="og:title" content="GUI Automation with RobotJS" />
    <meta property="og:description" content="In this post, I use RobotJS to implement a simple GUI automation workflow that updates a browser extension from a Git repository.
" />
    <meta property="og:image" content="https://nanx.me/image/martin-reisch-1b3Ix12HlkM-unsplash.jpg" />
    <meta property="og:image:secure_url" content="https://nanx.me/image/martin-reisch-1b3Ix12HlkM-unsplash.jpg" />
    <meta property="article:published_time" content="2022-09-05T20:30:00Z" />
    <meta property="article:modified_time" content="2022-09-05T20:30:00Z" />
    <meta property="article:author" content="Nan Xiao" />

    
    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@nanxstats">
    <meta name="twitter:creator" content="@nanxstats">
    
    <meta name="twitter:title" content="GUI Automation with RobotJS" />
    <meta name="twitter:description" content="In this post, I use RobotJS to implement a simple GUI automation workflow that updates a browser extension from a Git repository.
" />
    <meta name="twitter:image" content="https://nanx.me/image/martin-reisch-1b3Ix12HlkM-unsplash.jpg" />
    <meta name="twitter:image:alt" content="GUI Automation with RobotJS" />

    
    <meta property="og:linkedin:actor" content="nanxstats" />

    <link rel="canonical" href="https://nanx.me/blog/post/gui-automation-robotjs/">

    <link rel="stylesheet" href="https://nanx.me/css/tailwind.css" />
    <link rel="stylesheet" href="https://nanx.me/css/custom.css" />

    
    <link rel="stylesheet" href="https://nanx.me/css/textmate.css" />
    

    

    <link rel="shortcut icon"
        href="https://nanx.me/image/favicon.png">

    
</head>

<body class="bg-paper text-ink font-serif antialiased selection:bg-zinc-200">
    
<header class="py-8 lg:py-12 text-sm font-sans tracking-wide max-w-[67ch] mx-auto w-full px-4 sm:px-6">
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 sm:gap-0">
        <a href="https://nanx.me/" class="font-medium text-ink hover:text-accent transition-colors">
            Nan Xiao
        </a>
        <nav class="flex flex-wrap gap-4 sm:gap-6 text-zinc-600">
            
            
            <a class="text-ink font-medium"
                href="https://nanx.me/blog/">
                Blog
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/software/">
                Software
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/papers/">
                Papers
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/talks/">
                Talks
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/books/">
                Books
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/about/">
                About
            </a>
            
        </nav>
    </div>
</header>

<main class="content my-10 max-w-[65ch] mx-auto w-full px-4 sm:px-6">
    <article>
        <header class="mb-14">
            <h1 class="text-3xl lg:text-4xl font-sans tracking-tight text-ink font-medium mb-4">GUI Automation with RobotJS</h1>

            <div class="text-zinc-500 font-sans text-sm tracking-wide">
                
                
                <span class="author mr-2" title="Nan Xiao">
                    Nan Xiao
                </span>
                
                

                <span class="date middot tabular-nums mr-2" title='Mon Sep 5 2022 20:30:00 UTC'>
                    September 5, 2022
                </span>

                <span class="reading-time middot">
                    4 min read
                </span>

                <div class="mt-8 flex flex-wrap gap-2">
                    
                    <a href="https://nanx.me/tags/automation"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        automation
                    </a>
                    
                    <a href="https://nanx.me/tags/javascript"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        JavaScript
                    </a>
                    
                    <a href="https://nanx.me/tags/robotjs"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        RobotJS
                    </a>
                    
                    
                    
                </div>
            </div>

        </header>

        <div class="prose prose-zinc max-w-none">
            
    


<blockquote>
<p>The code in this post is also available in
this <a href="https://gist.github.com/nanxstats/2e307097b7dd0171bcfae2be8edebdfd">GitHub Gist</a>.</p>
</blockquote>
<blockquote>
<p>Disclaimer: the tools and configurations mentioned in this post are only
discussed as technical examples; they do not constitute an endorsement.
Use at your own risk.</p>
</blockquote>
<div class="float">
<img src="https://nanx.me/image/martin-reisch-1b3Ix12HlkM-unsplash.jpg" alt="Photo by Martin Reisch." />
<div class="figcaption">Photo by <a href="https://unsplash.com/photos/1b3Ix12HlkM">Martin Reisch</a>.</div>
</div>
<p>Today’s internet is not like it was 20 years ago for an older millennial like me.
Only judging by its appearance, the internet today is plagued with
cookie consent popups and paywalls. Well, maybe they exist for good
(commercial) reasons, but I constantly feel that they are designed
to be intrusive and break my reading flow. To me, that is counterproductive.</p>
<p>I find the “Annoyances” filters under the uBlock Origin filters list adequate
to block cookie notices. However, for paywalls, we need something more
specifically built. One possibility is the
bypass-paywalls-chrome-clean
extension. For reasons explained in its repo, such extensions are not allowed
on the Chrome web store, so it needs to be installed and updated manually
under developer mode on the extensions page.</p>
<div id="the-task" class="section level2">
<h2>The task</h2>
<p>The general steps to update the extension are:</p>
<ol style="list-style-type: decimal">
<li>Open the extensions page in the browser.</li>
<li>Click the “Remove” button to remove the old version.</li>
<li>Click the “Remove” button in the popup dialog to confirm.</li>
<li>Open the terminal, and pull the latest version from the Git repository.</li>
<li>Drag and drop the updated extension directory into the extensions page.</li>
<li>Close the opened browser tabs and terminal.</li>
</ol>
<p>Since these steps are repetitive and there is no obvious CLI or API
available for the actions involved, I find it a good exercise for GUI automation.
I choose <a href="https://www.npmjs.com/package/robotjs">RobotJS</a> to implement it
and will run the automation script using Node.js,
although there seem to be more modern JavaScript libraries for GUI automation,
for example, <a href="https://www.npmjs.com/package/@nut-tree/nut-js">nut.js</a>.</p>
<p>I have not tested the cross-platform compatibility of such libraries
besides running on macOS. Conceptually, the workflow can be easily
ported to more desktop environments.</p>
</div>
<div id="automate-with-robotjs" class="section level2">
<h2>Automate with RobotJS</h2>
<p>My implementation looks like this:</p>
<pre class="js"><code>const robot = require(&quot;robotjs&quot;);
const { execSync } = require(&quot;child_process&quot;);

const updateExtension = (coordRemove) =&gt; {
  // Open in extensions page in browser
  execSync(&#39;open -a &quot;Google Chrome&quot; chrome://extensions&#39;);

  // Move to and click &quot;Remove&quot; button of the extension
  robot.setMouseDelay(1000);
  robot.moveMouseSmooth(coordRemove[0], coordRemove[1]);
  robot.mouseClick();

  // Click &quot;Remove&quot; button in the confirm dialog
  robot.keyTap(&quot;enter&quot;);

  // Open iTerm (new tab) and do git pull
  execSync(&quot;open -a iTerm .&quot;);
  robot.typeStringDelayed(&quot;cd bpc &amp;&amp; git pull&quot;, 800);
  robot.keyTap(&quot;enter&quot;);

  // Open Finder and highlight the directory
  execSync(&quot;open -a Finder&quot;);
  robot.typeStringDelayed(&quot;bpc&quot;, 1000);

  // Get selected directory position by its highlighted color
  let screen = robot.getScreenSize();
  let img = robot.screen.capture(0, 0, screen.width, screen.height);

  // Support for higher density screens
  let multiplier = img.width / screen.width;

  // Find the x coordinate: likely covers the center of the screen
  let coordFinderX = screen.width / 2;

  // Find the y coordinate
  let colors = [];
  for (let i = 0; i &lt; screen.height; i++) {
    colors[i] = img.colorAt(coordFinderX * multiplier, i * multiplier);
  }

  let bluepixel = colors.indexOf(&quot;2961d9&quot;);
  robot.moveMouseSmooth(coordFinderX, bluepixel + 10);
  robot.mouseToggle(&quot;down&quot;);

  // Drag and drop into extensions tab
  robot.dragMouse(30, bluepixel + 50);
  setTimeout(() =&gt; {
    robot.mouseToggle(&quot;up&quot;);
  }, 500);

  // Close the popup options tabs, extension tab, Finder, and iTerm tabs
  setTimeout(() =&gt; {
    robot.keyTap(&quot;w&quot;, &quot;command&quot;);
  }, 5000);

  setTimeout(() =&gt; {
    robot.keyTap(&quot;w&quot;, &quot;command&quot;);
  }, 6000);

  setTimeout(() =&gt; {
    robot.keyTap(&quot;w&quot;, &quot;command&quot;);
  }, 7000);

  setTimeout(() =&gt; {
    execSync(&quot;open -a Finder&quot;);
    robot.keyTap(&quot;w&quot;, &quot;command&quot;);
  }, 8000);

  setTimeout(() =&gt; {
    execSync(&quot;open -a iTerm&quot;);
    robot.keyTap(&quot;w&quot;, &quot;command&quot;);
    robot.keyTap(&quot;w&quot;, &quot;command&quot;);
  }, 9000);
};</code></pre>
<p>After finding the coordinates of the “Remove” button after trial and error,
plug it into the function call. Perhaps this step can also be automated,
but I find it better to keep the code simple.</p>
<pre class="js"><code>updateExtension([235, 425]);</code></pre>
<p>We can then save the lines above in a <code>.js</code> file and run it with <code>node</code>:</p>
<div class="float">
<img src="robotjs.gif" alt="A demo run of the RobotJS GUI automation" />
<div class="figcaption">A demo run of the RobotJS GUI automation</div>
</div>
</div>
<div id="notes" class="section level2">
<h2>Notes</h2>
<p>Not surprisingly, the automation has a few essential prerequisites and assumptions.
The important ones are:</p>
<ol style="list-style-type: decimal">
<li>NodeJS and RobotJS are installed.</li>
<li>On the extensions page, Developer Mode is switched on.</li>
<li>The extension Git repo is cloned to a local directory.</li>
<li>The extension is already installed.</li>
<li>You are using the List view in Finder and using the default blue accent
color to correctly locate the folder when highlighted.</li>
<li>iTerm will require permissions when running this for the first time
to control the mouse/keyboard and take screenshots.
It will involve enabling iTerm in two categories, “Accessibility” and
“Screen Recording”, under System Preferences → Security &amp; Privacy → Privacy.</li>
</ol>
</div>



        </div>

        
        <nav class="pagination-nav mt-10 mb-3" aria-label="Blog post navigation">
            <div class="navigation-btns">
                
                <a href="https://nanx.me/blog/post/exp2vec/" class="btn-nav btn-prev w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Previous</div>
                        <div class="pagination-nav-label">&laquo; Training Tissue-Specific Gene Embeddings on GTEx Data</div>
                    </div>
                </a>
                

                
                <a href="https://nanx.me/blog/post/ectd-pkglite-paper/" class="btn-nav btn-next w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Next</div>
                        <div class="pagination-nav-label">New Paper Published: eCTD Submission with Analysis Using R &raquo;</div>
                    </div>
                </a>
                
            </div>
        </nav>
        

    </article>
</main>

<section id="comments">
    <div class="py-3 content">
        <div class="mx-auto max-w-[65ch] w-full px-4 sm:px-6">
            <div class="comments">
                <script src="https://utteranc.es/client.js" repo="nanxstats/blog-comments" issue-term="pathname"
                    label="comment" theme="github-light" crossorigin="anonymous" async>
                    </script>
            </div>
        </div>
    </div>
</section>
<footer class="mt-20 mb-10 text-center font-sans text-sm text-zinc-500 tracking-wide">
    <div class="tufte-grid">
        <div class="flex flex-col items-center gap-4">
            <div class="flex flex-wrap items-center justify-center gap-x-4 gap-y-2">
                
                
                <a href="https://github.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">GitHub</a>
                
                
                
                
                <a href="https://www.linkedin.com/in/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">LinkedIn</a>
                
                
                <a href="https://bsky.app/profile/nanxstats.bsky.social" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Bluesky</a>
                
                
                <a href="https://twitter.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Twitter</a>
                
                
                
                <a href="https://nanx.me/colophon/" class="hover:text-accent transition-colors">Colophon</a>
                
                
            </div>

            
            <div class="mt-2">
                © 2026 Nan Xiao. All rights reserved.
            </div>
            
        </div>
    </div>
</footer>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"
        integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/r.min.js" defer></script>
    
    <script>
        window.addEventListener('load', function () {
            hljs.highlightAll();
        }, true);
    </script>
    

    

    
    
    

    
</body>

</html>