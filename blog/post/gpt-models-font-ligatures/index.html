<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> You should (maybe) enable font ligatures when building with GPT models - Nan Xiao | 肖楠 </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="Explore the prevalence of the special token in GPT models and how programming ligatures in coding fonts may improve code readability using this convention. Discover popular monospace typefaces with ligature support that could improve developer experience when working with special tokens in large language models via the OpenAI API, LangChain, and text-generation-webui.
" />

    
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="Nan Xiao | 肖楠" />
    <meta property="og:url" content="https://nanx.me/blog/post/gpt-models-font-ligatures/" />
    <meta property="og:title" content="You should (maybe) enable font ligatures when building with GPT models" />
    <meta property="og:description" content="Explore the prevalence of the special token in GPT models and how programming ligatures in coding fonts may improve code readability using this convention. Discover popular monospace typefaces with ligature support that could improve developer experience when working with special tokens in large language models via the OpenAI API, LangChain, and text-generation-webui.
" />
    <meta property="og:image" content="https://nanx.me/image/florian-klauer--K6JMRMj4x4-unsplash.jpg" />
    <meta property="og:image:secure_url" content="https://nanx.me/image/florian-klauer--K6JMRMj4x4-unsplash.jpg" />
    <meta property="article:published_time" content=" 2024-06-19T03:30:00Z" />
    <meta property="article:modified_time" content=" 2024-06-19T03:30:00Z" />
    <meta property="article:author" content="Nan Xiao" />

    
    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@nanxstats">
    <meta name="twitter:creator" content="@nanxstats">
    
    <meta name="twitter:title" content="You should (maybe) enable font ligatures when building with GPT models" />
    <meta name="twitter:description" content="Explore the prevalence of the special token in GPT models and how programming ligatures in coding fonts may improve code readability using this convention. Discover popular monospace typefaces with ligature support that could improve developer experience when working with special tokens in large language models via the OpenAI API, LangChain, and text-generation-webui.
" />
    <meta name="twitter:image" content="https://nanx.me/image/florian-klauer--K6JMRMj4x4-unsplash.jpg" />
    <meta name="twitter:image:alt" content="You should (maybe) enable font ligatures when building with GPT models" />

    
    <meta property="og:linkedin:actor" content="nanxstats" />

    <link rel="canonical" href="https://nanx.me/blog/post/gpt-models-font-ligatures/">

    
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        serif: ['"Martina Plantijn"', 'Newsreader', 'Georgia', 'Cambria', '"Times New Roman"', 'Times', 'serif'],
                        sans: ['"Instrument Sans"', 'system-ui', '-apple-system', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', 'sans-serif'],
                        mono: ['"Liga Noto Sans Mono"', 'ui-monospace', 'SFMono-Regular', '"SF Mono"', 'Menlo', 'Consolas', 'monospace'],
                    },
                    colors: {
                        paper: '#fdfdfd',
                        ink: '#1c1c1c',
                        accent: '#991b1b',  
                    },
                    typography: {
                        DEFAULT: {
                            css: {
                                maxWidth: 'none',
                                color: '#1c1c1c',
                                '--tw-prose-body': '#1c1c1c',
                                '--tw-prose-headings': '#1c1c1c',
                                '--tw-prose-links': '#991b1b',
                                '--tw-prose-bold': '#111827',
                                '--tw-prose-counters': '#71717a',
                                '--tw-prose-bullets': '#d4d4d8',
                                '--tw-prose-hr': '#e4e4e7',
                                '--tw-prose-quotes': '#1c1c1c',
                                '--tw-prose-quote-borders': '#d4d4d8',
                                '--tw-prose-captions': '#71717a',
                                '--tw-prose-code': '#1c1c1c',
                                '--tw-prose-pre-code': '#1c1c1c',
                                '--tw-prose-pre-bg': '#fdfdfd',
                                '--tw-prose-th-borders': '#d4d4d8',
                                '--tw-prose-td-borders': '#e4e4e7',
                                'pre': {
                                    color: '#1c1c1c',
                                    backgroundColor: '#fdfdfd !important',
                                    border: '1px solid #e4e4e7',
                                },
                                a: {
                                    color: '#991b1b',
                                    textDecoration: 'none',
                                    fontWeight: '400',
                                    borderBottom: '1px solid transparent',
                                    transition: 'border-color 0.2s ease, color 0.2s ease',
                                },
                                'a:hover': {
                                    color: '#991b1b !important',
                                    borderBottomColor: '#991b1b !important',
                                },
                                h1: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em' },
                                h2: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em', marginTop: '2em' },
                                h3: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                h4: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                blockquote: {
                                    fontStyle: 'italic',
                                    fontWeight: '400',
                                    borderLeftWidth: '2px',
                                },
                                'code::before': { content: 'none' },
                                'code::after': { content: 'none' },
                                ':not(pre) > code': {
                                    fontWeight: '400',
                                    color: '#1c1c1c !important',
                                    backgroundColor: '#f4f4f5 !important',
                                    padding: '0.2em 0.4em',
                                    borderRadius: '0.25rem',
                                    fontSize: '0.875em',
                                },
                            },
                        },
                    },
                },
            },
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
            .tufte-grid {
                display: grid;
                grid-template-columns: 1fr min(65ch, 100%) 1fr;
                column-gap: 2rem;
            }
            .tufte-grid > * {
                grid-column: 2;
            }
            .tufte-grid > .full-width {
                grid-column: 1 / -1;
            }
            .tufte-grid > .margin-note {
                grid-column: 3;
                font-family: "Instrument Sans", sans-serif;
                font-size: 0.875rem;
                line-height: 1.4;
                color: #52525b;  
                margin-top: 0.25rem;
            }
            @media (max-width: 1024px) {
                .tufte-grid {
                    grid-template-columns: 1rem 1fr 1rem;
                }
                .tufte-grid > .margin-note {
                    grid-column: 2;
                    margin-top: 0.5rem;
                    margin-bottom: 1rem;
                    padding-left: 1rem;
                    border-left: 2px solid #e4e4e7;
                }
            }
        }
    </style>

    <link rel="stylesheet" href="https://nanx.me/css/custom.css" />

    
    <link rel="stylesheet" href="https://nanx.me/css/textmate.css" />
    

    

    <link rel="shortcut icon"
        href="https://nanx.me/image/favicon.png">

    
</head>

<body class="bg-paper text-ink font-serif antialiased selection:bg-zinc-200">
    
<header class="py-8 lg:py-12 text-sm font-sans tracking-wide max-w-[67ch] mx-auto w-full px-4 sm:px-6">
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 sm:gap-0">
        <a href="https://nanx.me/" class="font-medium text-ink hover:text-accent transition-colors">
            Nan Xiao
        </a>
        <nav class="flex flex-wrap gap-4 sm:gap-6 text-zinc-600">
            
            
            <a class="text-ink font-medium"
                href="https://nanx.me/blog/">
                Blog
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/software/">
                Software
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/papers/">
                Papers
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/talks/">
                Talks
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/books/">
                Books
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/about/">
                About
            </a>
            
        </nav>
    </div>
</header>

<main class="content my-10 lg:my-20 max-w-[65ch] mx-auto w-full px-4 sm:px-6">
    <article>
        <header class="mb-14">
            <h1 class="text-3xl lg:text-4xl font-sans tracking-tight text-ink font-medium mb-4">You should (maybe) enable font ligatures when building with GPT models</h1>

            <div class="text-zinc-500 font-sans text-sm tracking-wide">
                
                
                <span class="author" title="Nan Xiao">
                    Nan Xiao
                </span>
                
                

                <span class="date middot" title='Wed Jun 19 2024 03:30:00 UTC'>
                    June 19, 2024
                </span>

                <span class="reading-time middot">
                    2 min read
                </span>

                <div class="mt-8 flex flex-wrap gap-2">
                    
                    <a href="https://nanx.me/%20tags/gpt-models"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        GPT models
                    </a>
                    
                    <a href="https://nanx.me/%20tags/openai"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        OpenAI
                    </a>
                    
                    <a href="https://nanx.me/%20tags/large-language-model"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        large language model
                    </a>
                    
                    <a href="https://nanx.me/%20tags/endoftext"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        endoftext
                    </a>
                    
                    <a href="https://nanx.me/%20tags/tokenization"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        tokenization
                    </a>
                    
                    <a href="https://nanx.me/%20tags/special-tokens"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        special tokens
                    </a>
                    
                    <a href="https://nanx.me/%20tags/readability"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        readability
                    </a>
                    
                    <a href="https://nanx.me/%20tags/coding-fonts"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        coding fonts
                    </a>
                    
                    <a href="https://nanx.me/%20tags/programming-ligatures"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        programming ligatures
                    </a>
                    
                    
                    
                </div>
            </div>

        </header>

        <div class="prose prose-zinc max-w-none">
            
    


<div class="float">
<img src="https://nanx.me/image/florian-klauer--K6JMRMj4x4-unsplash.jpg" alt="Parts of a typewriter. Photo by Florian Klauer." />
<div class="figcaption">Parts of a typewriter. Photo by <a href="https://unsplash.com/photos/-K6JMRMj4x4">Florian Klauer</a>.</div>
</div>
<p>The token <strong>&lt;|endoftext|&gt;</strong> is a special token used as a document separator
for OpenAI GPT models. It has become quite prevalent if you look closely:</p>
<ul>
<li>It has been used since <a href="https://huggingface.co/docs/transformers/model_doc/gpt2">GPT-2</a>
and remains present in the OpenAI API for their latest models.
Their tokenizer package, tiktoken, includes logic to process text with these
<a href="https://github.com/openai/tiktoken/blob/c0ba74c238d18b4824c25f3c27fc8698055b9a76/tiktoken_ext/openai_public.py#L3-L7">special tokens</a>.</li>
<li>The markup <strong>&lt;|</strong> and <strong>|&gt;</strong> is widely used in the code bases of LangChain
and text-generation-webui. It usually serves as a lightweight templating
syntax to mark particular text sections for replacement.</li>
<li>Improper handling of this special token has led to <a href="https://www.lesswrong.com/posts/HvmhZR6EJEi7bEqBh/less-than-or-endoftext-or-greater-than-is-a-vanishing-text">interesting
results</a>
in chatbot interfaces.</li>
</ul>
<p>The use of <strong>&lt;|</strong> and <strong>|&gt;</strong> might seem random. My theory is that people who
introduced this convention use a coding font with programming ligatures.
As shown in the figures below, it makes more visual sense with
the ligatures enabled, as the cognitive load is greatly reduced when
distinguishing them. I find my brain finally starting to understand what
the code is trying to say.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="images/special-token-no-ligature.png" alt="Code snippet from text-generation-webui, ligatures off." width="100%" />
<p class="caption">
Figure 1: Code snippet from text-generation-webui, ligatures off.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="images/special-token-ligature.png" alt="Code snippet from text-generation-webui, ligatures on." width="100%" />
<p class="caption">
Figure 2: Code snippet from text-generation-webui, ligatures on.
</p>
</div>
<p>Now, here are five popular typefaces with original ligature designs
that I often use as my main coding font, displayed in regular weight (400).
You can find many more alternatives in the
<a href="https://github.com/ToxicFrog/Ligaturizer">ToxicFrog/Ligaturizer</a>
repository, where regular monospaced fonts are patched with Fira Code ligatures.</p>
<style type="text/css">
@font-face {
    font-display: swap;
    font-family: "Cascadia Code Regular";
    src: url("fonts/CascadiaCode-Regular.woff2") format("woff2");
    font-weight: 400;
}

@font-face {
    font-display: swap;
    font-family: "Fira Code Regular";
    src: url("fonts/FiraCode-Regular.woff2") format("woff2");
    font-weight: 400;
}

@font-face {
    font-display: swap;
    font-family: "Hasklig Regular";
    src: url("fonts/Hasklig-Regular.woff2") format("woff2");
    font-weight: 400;
}

@font-face {
    font-display: swap;
    font-family: "JetBrains Mono Regular";
    src: url("fonts/JetBrainsMono-Regular.woff2") format("woff2");
    font-weight: 400;
}

@font-face {
    font-display: swap;
    font-family: "Monaspace Argon Regular";
    src: url("fonts/MonaspaceArgon-Regular.woff2") format("woff2");
    font-weight: 400;
}

.font-cascadia-code pre code {
    font-family: "Cascadia Code Regular" !important;
    font-feature-settings: normal !important;
}
.font-fira-code pre code {
    font-family: "Fira Code Regular" !important;
    font-feature-settings: normal !important;
}
.font-hasklig pre code {
    font-family: "Hasklig Regular" !important;
    font-feature-settings: normal !important;
}
.font-jetbrains-mono pre code {
    font-family: "JetBrains Mono Regular" !important;
    font-feature-settings: normal !important;
}
.font-monaspace-argon pre code {
    font-family: "Monaspace Argon Regular" !important;
    font-feature-settings: "ss01", "ss02", "ss03", "ss05", "ss07", "ss09" !important;
}
</style>
<div id="cascadia-code" class="section level2">
<h2>Cascadia Code</h2>
<div class="font-cascadia-code">
<pre class="python"><code>ENDOFTEXT = &quot;&lt;|endoftext|&gt;&quot;
FIM_PREFIX = &quot;&lt;|fim_prefix|&gt;&quot;
FIM_MIDDLE = &quot;&lt;|fim_middle|&gt;&quot;
FIM_SUFFIX = &quot;&lt;|fim_suffix|&gt;&quot;
ENDOFPROMPT = &quot;&lt;|endofprompt|&gt;&quot;
## :: := =&gt; &lt;- -&gt; == != &lt;= &gt;= ++ || &amp;&amp;</code></pre>
</div>
</div>
<div id="fira-code" class="section level2">
<h2>Fira Code</h2>
<div class="font-fira-code">
<pre class="python"><code>ENDOFTEXT = &quot;&lt;|endoftext|&gt;&quot;
FIM_PREFIX = &quot;&lt;|fim_prefix|&gt;&quot;
FIM_MIDDLE = &quot;&lt;|fim_middle|&gt;&quot;
FIM_SUFFIX = &quot;&lt;|fim_suffix|&gt;&quot;
ENDOFPROMPT = &quot;&lt;|endofprompt|&gt;&quot;
## :: := =&gt; &lt;- -&gt; == != &lt;= &gt;= ++ || &amp;&amp;</code></pre>
</div>
</div>
<div id="hasklig" class="section level2">
<h2>Hasklig</h2>
<div class="font-hasklig">
<pre class="python"><code>ENDOFTEXT = &quot;&lt;|endoftext|&gt;&quot;
FIM_PREFIX = &quot;&lt;|fim_prefix|&gt;&quot;
FIM_MIDDLE = &quot;&lt;|fim_middle|&gt;&quot;
FIM_SUFFIX = &quot;&lt;|fim_suffix|&gt;&quot;
ENDOFPROMPT = &quot;&lt;|endofprompt|&gt;&quot;
## :: := =&gt; &lt;- -&gt; == != &lt;= &gt;= ++ || &amp;&amp;</code></pre>
</div>
</div>
<div id="jetbrains-mono" class="section level2">
<h2>JetBrains Mono</h2>
<div class="font-jetbrains-mono">
<pre class="python"><code>ENDOFTEXT = &quot;&lt;|endoftext|&gt;&quot;
FIM_PREFIX = &quot;&lt;|fim_prefix|&gt;&quot;
FIM_MIDDLE = &quot;&lt;|fim_middle|&gt;&quot;
FIM_SUFFIX = &quot;&lt;|fim_suffix|&gt;&quot;
ENDOFPROMPT = &quot;&lt;|endofprompt|&gt;&quot;
## :: := =&gt; &lt;- -&gt; == != &lt;= &gt;= ++ || &amp;&amp;</code></pre>
</div>
</div>
<div id="monaspace-argon" class="section level2">
<h2>Monaspace Argon</h2>
<div class="font-monaspace-argon">
<pre class="python"><code>ENDOFTEXT = &quot;&lt;|endoftext|&gt;&quot;
FIM_PREFIX = &quot;&lt;|fim_prefix|&gt;&quot;
FIM_MIDDLE = &quot;&lt;|fim_middle|&gt;&quot;
FIM_SUFFIX = &quot;&lt;|fim_suffix|&gt;&quot;
ENDOFPROMPT = &quot;&lt;|endofprompt|&gt;&quot;
## :: := =&gt; &lt;- -&gt; == != &lt;= &gt;= ++ || &amp;&amp;</code></pre>
</div>
<p>Of course, this post should end with a proper…</p>
<p><code>&lt;|endoftext|&gt;</code></p>
</div>



        </div>

        
        <nav class="pagination-nav mt-10 mb-3" aria-label="Blog post navigation">
            <div class="navigation-btns">
                
                <a href="https://nanx.me/blog/post/ggsci-3-1-0/" class="btn-nav btn-prev w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Previous</div>
                        <div class="pagination-nav-label">&laquo; ggsci 3.1.0, ggsurvfit example, and reverse dependency check</div>
                    </div>
                </a>
                

                
                <a href="https://nanx.me/blog/post/ggsci-3-2-0/" class="btn-nav btn-next w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Next</div>
                        <div class="pagination-nav-label">ggsci 3.2.0: new color palettes from Observable, Bootstrap, and Tailwind CSS &raquo;</div>
                    </div>
                </a>
                
            </div>
        </nav>
        

    </article>
</main>

<section id="comments">
    <div class="py-3 content">
        <div class="mx-auto max-w-[65ch] w-full px-4 sm:px-6">
            <div class="comments">
                <script src="https://utteranc.es/client.js" repo="nanxstats/blog-comments" issue-term="pathname"
                    label="comment" theme="github-light" crossorigin="anonymous" async>
                    </script>
            </div>
        </div>
    </div>
</section>
<footer class="mt-20 mb-10 text-center font-sans text-sm text-zinc-500 tracking-wide">
    <div class="tufte-grid">
        <div class="flex flex-col items-center gap-4">
            <div class="flex flex-wrap items-center justify-center gap-x-4 gap-y-2">
                
                
                <a href="https://github.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">GitHub</a>
                
                
                
                
                <a href="https://www.linkedin.com/in/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">LinkedIn</a>
                
                
                <a href="https://bsky.app/profile/nanxstats.bsky.social" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Bluesky</a>
                
                
                <a href="https://twitter.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Twitter</a>
                
                
                
                <a href="https://nanx.me/colophon/" class="hover:text-accent transition-colors">Colophon</a>
                
                
            </div>

            
            <div class="mt-2">
                © 2026 Nan Xiao. All rights reserved.
            </div>
            
        </div>
    </div>
</footer>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"
        integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/r.min.js" defer></script>
    
    <script>
        window.addEventListener('load', function () {
            hljs.highlightAll();
        }, true);
    </script>
    

    

    
    
    

    
</body>

</html>