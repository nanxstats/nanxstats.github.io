<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> Introducing pkglite for Python - Nan Xiao | 肖楠 </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="pkglite for Python is a simple framework to pack source packages written in any language into a text file and restore them, supporting reproducible research and standard engineering workflows across different environments.
" />

    
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="Nan Xiao | 肖楠" />
    <meta property="og:url" content="https://nanx.me/blog/post/pkglite-python/" />
    <meta property="og:title" content="Introducing pkglite for Python" />
    <meta property="og:description" content="pkglite for Python is a simple framework to pack source packages written in any language into a text file and restore them, supporting reproducible research and standard engineering workflows across different environments.
" />
    <meta property="og:image" content="https://nanx.me/image/yann-allegre-yGprtDYbyoE-unsplash.jpg" />
    <meta property="og:image:secure_url" content="https://nanx.me/image/yann-allegre-yGprtDYbyoE-unsplash.jpg" />
    <meta property="article:published_time" content="2025-01-16T02:11:00Z" />
    <meta property="article:modified_time" content="2025-01-16T02:11:00Z" />
    <meta property="article:author" content="Nan Xiao" />

    
    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@nanxstats">
    <meta name="twitter:creator" content="@nanxstats">
    
    <meta name="twitter:title" content="Introducing pkglite for Python" />
    <meta name="twitter:description" content="pkglite for Python is a simple framework to pack source packages written in any language into a text file and restore them, supporting reproducible research and standard engineering workflows across different environments.
" />
    <meta name="twitter:image" content="https://nanx.me/image/yann-allegre-yGprtDYbyoE-unsplash.jpg" />
    <meta name="twitter:image:alt" content="Introducing pkglite for Python" />

    
    <meta property="og:linkedin:actor" content="nanxstats" />

    <link rel="canonical" href="https://nanx.me/blog/post/pkglite-python/">

    
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        serif: ['"Martina Plantijn"', 'Newsreader', 'Georgia', 'Cambria', '"Times New Roman"', 'Times', 'serif'],
                        sans: ['"Instrument Sans"', 'system-ui', '-apple-system', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', 'sans-serif'],
                        mono: ['"Liga Noto Sans Mono"', 'ui-monospace', 'SFMono-Regular', '"SF Mono"', 'Menlo', 'Consolas', 'monospace'],
                    },
                    colors: {
                        paper: '#fdfdfd',
                        ink: '#1c1c1c',
                        accent: '#991b1b',  
                    },
                    typography: {
                        DEFAULT: {
                            css: {
                                maxWidth: 'none',
                                color: '#1c1c1c',
                                '--tw-prose-body': '#1c1c1c',
                                '--tw-prose-headings': '#1c1c1c',
                                '--tw-prose-links': '#991b1b',
                                '--tw-prose-bold': '#111827',
                                '--tw-prose-counters': '#71717a',
                                '--tw-prose-bullets': '#d4d4d8',
                                '--tw-prose-hr': '#e4e4e7',
                                '--tw-prose-quotes': '#1c1c1c',
                                '--tw-prose-quote-borders': '#d4d4d8',
                                '--tw-prose-captions': '#71717a',
                                '--tw-prose-code': '#1c1c1c',
                                '--tw-prose-pre-code': '#1c1c1c',
                                '--tw-prose-pre-bg': '#fdfdfd',
                                '--tw-prose-th-borders': '#d4d4d8',
                                '--tw-prose-td-borders': '#e4e4e7',
                                'pre': {
                                    color: '#1c1c1c',
                                    backgroundColor: '#fdfdfd !important',
                                    border: '1px solid #e4e4e7',
                                },
                                a: {
                                    color: '#991b1b',
                                    textDecoration: 'none',
                                    fontWeight: '400',
                                    borderBottom: '1px solid transparent',
                                    transition: 'border-color 0.2s ease, color 0.2s ease',
                                },
                                'a:hover': {
                                    color: '#991b1b !important',
                                    borderBottomColor: '#991b1b !important',
                                },
                                h1: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em' },
                                h2: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em', marginTop: '2em' },
                                h3: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                h4: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                blockquote: {
                                    fontStyle: 'italic',
                                    fontWeight: '400',
                                    borderLeftWidth: '2px',
                                },
                                'code::before': { content: 'none' },
                                'code::after': { content: 'none' },
                                ':not(pre) > code': {
                                    fontWeight: '400',
                                    color: '#1c1c1c !important',
                                    backgroundColor: '#f4f4f5 !important',
                                    padding: '0.2em 0.4em',
                                    borderRadius: '0.25rem',
                                    fontSize: '0.875em',
                                },
                            },
                        },
                    },
                },
            },
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
            .tufte-grid {
                display: grid;
                grid-template-columns: 1fr min(65ch, 100%) 1fr;
                column-gap: 2rem;
            }
            .tufte-grid > * {
                grid-column: 2;
            }
            .tufte-grid > .full-width {
                grid-column: 1 / -1;
            }
            .tufte-grid > .margin-note {
                grid-column: 3;
                font-family: "Instrument Sans", sans-serif;
                font-size: 0.875rem;
                line-height: 1.4;
                color: #52525b;  
                margin-top: 0.25rem;
            }
            @media (max-width: 1024px) {
                .tufte-grid {
                    grid-template-columns: 1rem 1fr 1rem;
                }
                .tufte-grid > .margin-note {
                    grid-column: 2;
                    margin-top: 0.5rem;
                    margin-bottom: 1rem;
                    padding-left: 1rem;
                    border-left: 2px solid #e4e4e7;
                }
            }
        }
    </style>

    <link rel="stylesheet" href="https://nanx.me/css/custom.css" />

    
    <link rel="stylesheet" href="https://nanx.me/css/textmate.css" />
    

    

    <link rel="shortcut icon"
        href="https://nanx.me/image/favicon.png">

    
</head>

<body class="bg-paper text-ink font-serif antialiased selection:bg-zinc-200">
    
<header class="py-8 lg:py-12 text-sm font-sans tracking-wide max-w-[67ch] mx-auto w-full px-4 sm:px-6">
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 sm:gap-0">
        <a href="https://nanx.me/" class="font-medium text-ink hover:text-accent transition-colors">
            Nan Xiao
        </a>
        <nav class="flex flex-wrap gap-4 sm:gap-6 text-zinc-600">
            
            
            <a class="text-ink font-medium"
                href="https://nanx.me/blog/">
                Blog
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/software/">
                Software
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/papers/">
                Papers
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/talks/">
                Talks
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/books/">
                Books
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/about/">
                About
            </a>
            
        </nav>
    </div>
</header>

<main class="content my-10 lg:my-20 max-w-[65ch] mx-auto w-full px-4 sm:px-6">
    <article>
        <header class="mb-14">
            <h1 class="text-3xl lg:text-4xl font-sans tracking-tight text-ink font-medium mb-4">Introducing pkglite for Python</h1>

            <div class="text-zinc-500 font-sans text-sm tracking-wide">
                
                
                <span class="author" title="Nan Xiao">
                    Nan Xiao
                </span>
                
                

                <span class="date middot" title='Thu Jan 16 2025 02:11:00 UTC'>
                    January 16, 2025
                </span>

                <span class="reading-time middot">
                    3 min read
                </span>

                <div class="mt-8 flex flex-wrap gap-2">
                    
                    <a href="https://nanx.me/tags/python"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        Python
                    </a>
                    
                    <a href="https://nanx.me/tags/python-packages"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        Python packages
                    </a>
                    
                    <a href="https://nanx.me/tags/pkglite"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        pkglite
                    </a>
                    
                    <a href="https://nanx.me/tags/clinical-trials"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        clinical trials
                    </a>
                    
                    <a href="https://nanx.me/tags/regulatory-submission"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        regulatory submission
                    </a>
                    
                    <a href="https://nanx.me/tags/reproducible-research"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        reproducible research
                    </a>
                    
                    <a href="https://nanx.me/tags/retrieval-augmented-generation"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        retrieval-augmented generation
                    </a>
                    
                    
                    
                </div>
            </div>

        </header>

        <div class="prose prose-zinc max-w-none">
            
    


<div class="float">
<img src="https://nanx.me/image/yann-allegre-yGprtDYbyoE-unsplash.jpg" alt="Les Menuires, France. Photo by Yann Allegre." />
<div class="figcaption">Les Menuires, France. Photo by <a href="https://unsplash.com/photos/yGprtDYbyoE">Yann Allegre</a>.</div>
</div>
<p>I am pleased to introduce
<a href="https://pharmaverse.github.io/py-pkglite/">pkglite for Python</a>,
now available on PyPI.
pkglite for Python provides a minimalist framework for packing source packages
written in any programming language into a text file and restoring them to
their original directory structure. You can install it with:</p>
<pre class="bash"><code>pip install pkglite</code></pre>
<p>For installation as a global command-line tool,
<a href="https://packaging.python.org/en/latest/guides/installing-stand-alone-command-line-tools/">use pipx</a>:</p>
<pre class="bash"><code>pipx install pkglite</code></pre>
<div id="context" class="section level2">
<h2>Context</h2>
<p>Four years ago, we released the R package pkglite,
designed for bidirectional conversion of R packages.
The motivation behind pkglite for R, including its role in supporting eCTD
submissions, was summarized in our
<a href="https://nanx.me/blog/post/ectd-pkglite-paper/"><em>Clinical Trials</em> paper</a> <span class="citation">(<a href="#ref-zhao2023electronic">Zhao et al. 2023</a>)</span>.
We also explored its application in
<a href="https://nanx.me/blog/post/pkglite-llm-prompt/">retrieval-augmented generation</a>
to provide code context to large language models.</p>
<p>pkglite for R has since been adopted in multiple real-world applications,
including the first two R Consortium open-source R submissions
(<a href="https://rconsortium.github.io/submissions-wg/pilot1.html">pilot 1</a>,
<a href="https://rconsortium.github.io/submissions-wg/pilot2.html">pilot 2</a>),
and sponsor-led submissions
(<a href="https://youtu.be/t33dS17QHuA?t=2776">webinar 1</a>,
<a href="https://youtu.be/BlJNILSoZlM?t=2468">webinar 2</a>).
It is also featured in the <a href="https://pharmaverse.org/e2eclinical/esub/">pharmaverse end-to-end clinical reporting
packages</a>.</p>
<p>The overwhelmingly positive feedback on the R package motivated me
to consider: what’s next?</p>
</div>
<div id="creating-pkglite-for-python" class="section level2">
<h2>Creating pkglite for Python</h2>
<p>To address this, I asked myself a broader question: what do people need?
Many colleagues and collaborators of mine use Python and other languages daily.
Extending the capability to pack and exchange source packages written in their
language of choice into plain text felt like a natural progression.</p>
<p>This goal led to several key design updates in pkglite for Python:</p>
<ul>
<li><p><strong>Language-agnostic design</strong>.
To support any programming language, I replaced R-specific packing scope
specifications with a <code>.pkgliteignore</code> configuration file,
compliant with the gitignore format standard.</p></li>
<li><p><strong>Command-line interface</strong>.
Alongside the Python API, pkglite for Python includes a CLI built with
<a href="https://github.com/fastapi/typer">Typer</a>. This enables seamless integration
into shell scripts and standard engineering workflows.</p></li>
<li><p><strong>Optimized tooling</strong>.
File type recognition now relies on a content-based
<a href="https://nanx.me/blog/post/txtvsbin/">zlib algorithm</a>,
replacing file-extension-based methods.
The packed file parser has been rewritten using finite state machines
for improved maintainability.
Additionally, UTF-8 encoding is enforced for all text files across platforms.</p></li>
</ul>
</div>
<div id="performance-testing" class="section level2">
<h2>Performance testing</h2>
<p>pkglite for Python is developed with performance in mind. Using this
<a href="bench.sh"><code>bench.sh</code></a> script, I tested packing and unpacking an entire
Python project with the virtual environment, which offers a realistic mix
of text and binary files.</p>
<p>On an M2 MacBook Air (2022), packing the project generated a 1.1 GB text file
in 16 seconds:</p>
<pre class="text"><code>Packing...
Packing complete.
Output file size: 1.18 GB
Packing time: 16 seconds
Packing write speed: 76.04 MB/s</code></pre>
<p>Unpacking from the file took only 8 seconds:</p>
<pre class="text"><code>Unpacking...
Unpacking complete.
Unpacking time: 8 seconds
Unpacking read speed: 152.09 MB/s</code></pre>
</div>
<div id="acknowledgements" class="section level2">
<h2>Acknowledgements</h2>
<p>I am deeply grateful to my original pkglite R package coauthors,
Keaven Anderson and Yilong Zhang, for their encouragement to explore new ideas.
My thanks also go to Ross Farrugia and the pharmaverse council for including
the package and providing GitHub hosting, plus everyone who kindly contributed
valuable time for code reviews and validations.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-zhao2023electronic" class="csl-entry">
Zhao, Yujie, Nan Xiao, Keaven Anderson, and Yilong Zhang. 2023. <span>“Electronic Common Technical Document Submission with Analysis Using <span>R</span>.”</span> <em>Clinical Trials</em> 20 (1): 89–92. <a href="https://doi.org/10.1177/17407745221123244">https://doi.org/10.1177/17407745221123244</a>.
</div>
</div>
</div>



        </div>

        
        <nav class="pagination-nav mt-10 mb-3" aria-label="Blog post navigation">
            <div class="navigation-btns">
                
                <a href="https://nanx.me/blog/post/testthat-snapshot-monkey-patch/" class="btn-nav btn-prev w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Previous</div>
                        <div class="pagination-nav-label">&laquo; Customize testthat snapshot directory with monkey patching</div>
                    </div>
                </a>
                

                
                <a href="https://nanx.me/blog/post/rstudio-projectid/" class="btn-nav btn-next w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Next</div>
                        <div class="pagination-nav-label">Prevent RStudio 2024.12.0 from adding ProjectID to .Rproj files &raquo;</div>
                    </div>
                </a>
                
            </div>
        </nav>
        

    </article>
</main>

<section id="comments">
    <div class="py-3 content">
        <div class="mx-auto max-w-[65ch] w-full px-4 sm:px-6">
            <div class="comments">
                <script src="https://utteranc.es/client.js" repo="nanxstats/blog-comments" issue-term="pathname"
                    label="comment" theme="github-light" crossorigin="anonymous" async>
                    </script>
            </div>
        </div>
    </div>
</section>
<footer class="mt-20 mb-10 text-center font-sans text-sm text-zinc-500 tracking-wide">
    <div class="tufte-grid">
        <div class="flex flex-col items-center gap-4">
            <div class="flex flex-wrap items-center justify-center gap-x-4 gap-y-2">
                
                
                <a href="https://github.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">GitHub</a>
                
                
                
                
                <a href="https://www.linkedin.com/in/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">LinkedIn</a>
                
                
                <a href="https://bsky.app/profile/nanxstats.bsky.social" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Bluesky</a>
                
                
                <a href="https://twitter.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Twitter</a>
                
                
                
                <a href="https://nanx.me/colophon/" class="hover:text-accent transition-colors">Colophon</a>
                
                
            </div>

            
            <div class="mt-2">
                © 2026 Nan Xiao. All rights reserved.
            </div>
            
        </div>
    </div>
</footer>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"
        integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/r.min.js" defer></script>
    
    <script>
        window.addEventListener('load', function () {
            hljs.highlightAll();
        }, true);
    </script>
    

    

    
    
    

    
</body>

</html>