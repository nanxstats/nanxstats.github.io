<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> tinytopics: GPU-accelerated topic modeling via constrained neural Poisson NMF - Nan Xiao | 肖楠 </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="Introducing tinytopics, a lightweight Python package for GPU-accelerated topic modeling using constrained neural Poisson NMF. Built on PyTorch, tinytopics offers scalable topic modeling for large datasets. This post shares the motivation, features, and examples to help you get started with tinytopics.
" />

    
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="Nan Xiao | 肖楠" />
    <meta property="og:url" content="https://nanx.me/blog/post/tinytopics/" />
    <meta property="og:title" content="tinytopics: GPU-accelerated topic modeling via constrained neural Poisson NMF" />
    <meta property="og:description" content="Introducing tinytopics, a lightweight Python package for GPU-accelerated topic modeling using constrained neural Poisson NMF. Built on PyTorch, tinytopics offers scalable topic modeling for large datasets. This post shares the motivation, features, and examples to help you get started with tinytopics.
" />
    <meta property="og:image" content="https://nanx.me/image/tim-foster-jhovC0t8f-8-unsplash.jpg" />
    <meta property="og:image:secure_url" content="https://nanx.me/image/tim-foster-jhovC0t8f-8-unsplash.jpg" />
    <meta property="article:published_time" content="2024-10-26T20:42:00Z" />
    <meta property="article:modified_time" content="2024-10-26T20:42:00Z" />
    <meta property="article:author" content="Nan Xiao" />

    
    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@nanxstats">
    <meta name="twitter:creator" content="@nanxstats">
    
    <meta name="twitter:title" content="tinytopics: GPU-accelerated topic modeling via constrained neural Poisson NMF" />
    <meta name="twitter:description" content="Introducing tinytopics, a lightweight Python package for GPU-accelerated topic modeling using constrained neural Poisson NMF. Built on PyTorch, tinytopics offers scalable topic modeling for large datasets. This post shares the motivation, features, and examples to help you get started with tinytopics.
" />
    <meta name="twitter:image" content="https://nanx.me/image/tim-foster-jhovC0t8f-8-unsplash.jpg" />
    <meta name="twitter:image:alt" content="tinytopics: GPU-accelerated topic modeling via constrained neural Poisson NMF" />

    
    <meta property="og:linkedin:actor" content="nanxstats" />

    <link rel="canonical" href="https://nanx.me/blog/post/tinytopics/">

    <link rel="stylesheet" href="https://nanx.me/css/tailwind.css" />
    <link rel="stylesheet" href="https://nanx.me/css/custom.css" />

    
    <link rel="stylesheet" href="https://nanx.me/css/textmate.css" />
    

    

    <link rel="shortcut icon"
        href="https://nanx.me/image/favicon.png">

    
</head>

<body class="bg-paper text-ink font-serif antialiased selection:bg-zinc-200">
    
<header class="py-8 lg:py-12 text-sm font-sans tracking-wide max-w-[67ch] mx-auto w-full px-4 sm:px-6">
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 sm:gap-0">
        <a href="https://nanx.me/" class="font-medium text-ink hover:text-accent transition-colors">
            Nan Xiao
        </a>
        <nav class="flex flex-wrap gap-4 sm:gap-6 text-zinc-600">
            
            
            <a class="text-ink font-medium"
                href="https://nanx.me/blog/">
                Blog
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/software/">
                Software
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/papers/">
                Papers
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/talks/">
                Talks
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/books/">
                Books
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/about/">
                About
            </a>
            
        </nav>
    </div>
</header>

<main class="content my-10 max-w-[65ch] mx-auto w-full px-4 sm:px-6">
    <article>
        <header class="mb-14">
            <h1 class="text-3xl lg:text-4xl font-sans tracking-tight text-ink font-medium mb-4">tinytopics: GPU-accelerated topic modeling via constrained neural Poisson NMF</h1>

            <div class="text-zinc-500 font-sans text-sm tracking-wide">
                
                
                <span class="author mr-2" title="Nan Xiao">
                    Nan Xiao
                </span>
                
                

                <span class="date middot tabular-nums mr-2" title='Sat Oct 26 2024 20:42:00 UTC'>
                    October 26, 2024
                </span>

                <span class="reading-time middot">
                    3 min read
                </span>

                <div class="mt-8 flex flex-wrap gap-2">
                    
                    <a href="https://nanx.me/tags/python"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        Python
                    </a>
                    
                    <a href="https://nanx.me/tags/python-packages"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        Python packages
                    </a>
                    
                    <a href="https://nanx.me/tags/pytorch"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        PyTorch
                    </a>
                    
                    <a href="https://nanx.me/tags/topic-modeling"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        topic modeling
                    </a>
                    
                    <a href="https://nanx.me/tags/matrix-factorization"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        matrix factorization
                    </a>
                    
                    <a href="https://nanx.me/tags/natural-language-processing"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        natural language processing
                    </a>
                    
                    <a href="https://nanx.me/tags/gpu"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        GPU
                    </a>
                    
                    <a href="https://nanx.me/tags/deep-learning"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        deep learning
                    </a>
                    
                    <a href="https://nanx.me/tags/neural-network"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        neural network
                    </a>
                    
                    
                    
                </div>
            </div>

        </header>

        <div class="prose prose-zinc max-w-none">
            
    


<div class="float">
<img src="https://nanx.me/image/tim-foster-jhovC0t8f-8-unsplash.jpg" alt="Downhill mountain biking. Photo by Tim Foster." />
<div class="figcaption">Downhill mountain biking.
Photo by <a href="https://unsplash.com/photos/jhovC0t8f-8">Tim Foster</a>.</div>
</div>
<p>I’m excited to share that my first Python package,
<a href="https://nanx.me/tinytopics/">tinytopics</a>,
is now available on PyPI. You can install it using</p>
<pre class="bash"><code>pip install tinytopics</code></pre>
<p>tinytopics is a minimalist solution designed to scale up topic modeling
tasks on CPUs and GPUs using PyTorch.</p>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Fitting topic models at scale using classical algorithms on CPUs can be slow.
<span class="citation">Carbonetto et al. (<a href="#ref-carbonetto2022nmf">2022</a>)</span> demonstrated the equivalence between Poisson non-negative matrix factorization (NMF) and multinomial topic model likelihoods.
They proposed a novel optimization strategy: fit a Poisson NMF via
coordinate descent, then recover the corresponding topic model through
a simple transformation. This method was implemented in their R package,
<a href="https://cran.r-project.org/package=fastTopics">fastTopics</a>.</p>
<p>Building on this theoretical insight, tinytopics takes a different
approach by directly optimizing a sum-to-one constrained neural Poisson NMF
problem with stochastic gradient methods.</p>
</div>
<div id="when-to-use-tinytopics" class="section level2">
<h2>When to use tinytopics</h2>
<p>For standard topic modeling tasks, I think fastTopics is already an excellent
solution because it is fast and can generate high-quality models with default
settings (<a href="https://nanx.me/blog/post/sensible-defaults/">sensible defaults</a>).
Plus, I can’t praise its ergonomic API design enough, which can be
summarized as “topic modeling for humans”.</p>
<p>You might find tinytopics a viable alternative option if you care more about:</p>
<ul>
<li><strong>Scale and speed</strong>. For extra-large datasets, tinytopics can leverage GPUs to
accelerate computations. You can also use <a href="https://docs.pytorch.org/tutorials/distributed.html">PyTorch distributed
training</a> to scale
across multiple GPUs or machines if single card VRAM is insufficient.</li>
<li><strong>Model customization</strong>. The constrained neural Poisson NMF in tinytopics
is a flexible, differentiable model. You can adapt it by adding new layers,
incorporating regularization, or even integrating other data modalities,
such as images or videos, for joint modeling.</li>
</ul>
</div>
<div id="when-not-to-use-tinytopics" class="section level2">
<h2>When not to use tinytopics</h2>
<p>tinytopics might not be the best option if you need:</p>
<ul>
<li><strong>Theoretical guarantees</strong>. Since tinytopics solves an approximate version
of the exact Poisson NMF problem using stochastic gradient methods, it may
lack the convergence, consistency, and identifiability guarantees often
found in classical algorithms.</li>
<li><strong>Minimal parameter tuning</strong>. While tinytopics uses modern stochastic gradient
optimizers and schedulers, you might still need to adjust hyperparameters to
get optimal results, depending on your dataset. This can require some
empirical fine-tuning and can be tricky to get right.</li>
</ul>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>I created three vignettes to demonstrate tinytopics’ functionality,
result accuracy, and performance on GPU:</p>
<ul>
<li><a href="https://nanx.me/tinytopics/articles/get-started/">Getting started guide with synthetic count data</a>.</li>
<li><a href="https://nanx.me/tinytopics/articles/benchmark/">CPU vs. GPU training speed benchmark</a>.</li>
<li><a href="https://nanx.me/tinytopics/articles/text/">Text data topic modeling example</a>.</li>
</ul>
</div>
<div id="python-toolchain-that-simplified-development" class="section level2">
<h2>Python toolchain that simplified development</h2>
<p>I wanted to thank the creators of the following software for improving the
Python package development experience:</p>
<ul>
<li><a href="https://pytorch.org/">PyTorch</a>.
It just works. If you are going to build for GPU, choose PyTorch.</li>
<li><a href="https://squidfunk.github.io/mkdocs-material/">mkdocs-material</a>.
A Markdown-first documentation website framework that, with mkdocs and mkdocstrings,
makes package documentation generation efficient and enjoyable.</li>
<li><a href="https://rye.astral.sh/">Rye</a>.
The package and project environment manager I wish I had known earlier!
I’m grateful that my friend <a href="https://github.com/svm-zhang">Simo</a> suggested
Rye and Neovim so that I can focus on writing code and be more productive.</li>
</ul>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-carbonetto2022nmf" class="csl-entry">
Carbonetto, Peter, Abhishek Sarkar, Zihao Wang, and Matthew Stephens. 2022. <span>“Non-Negative Matrix Factorization Algorithms Greatly Improve Topic Model Fits.”</span> <em>arXiv Preprint arXiv:2105.13440</em>. <a href="https://arxiv.org/abs/2105.13440">https://arxiv.org/abs/2105.13440</a>.
</div>
</div>
</div>



        </div>

        
        <nav class="pagination-nav mt-10 mb-3" aria-label="Blog post navigation">
            <div class="navigation-btns">
                
                <a href="https://nanx.me/blog/post/flux-lora/" class="btn-nav btn-prev w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Previous</div>
                        <div class="pagination-nav-label">&laquo; FLUX.1 &#43; LoRA for styled image generation</div>
                    </div>
                </a>
                

                
                <a href="https://nanx.me/blog/post/tinyvdiff/" class="btn-nav btn-next w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Next</div>
                        <div class="pagination-nav-label">tinyvdiff: Minimalist visual regression testing plugin for pytest &raquo;</div>
                    </div>
                </a>
                
            </div>
        </nav>
        

    </article>
</main>

<section id="comments">
    <div class="py-3 content">
        <div class="mx-auto max-w-[65ch] w-full px-4 sm:px-6">
            <div class="comments">
                <script src="https://utteranc.es/client.js" repo="nanxstats/blog-comments" issue-term="pathname"
                    label="comment" theme="github-light" crossorigin="anonymous" async>
                    </script>
            </div>
        </div>
    </div>
</section>
<footer class="mt-20 mb-10 text-center font-sans text-sm text-zinc-500 tracking-wide">
    <div class="tufte-grid">
        <div class="flex flex-col items-center gap-4">
            <div class="flex flex-wrap items-center justify-center gap-x-4 gap-y-2">
                
                
                <a href="https://github.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">GitHub</a>
                
                
                
                
                <a href="https://www.linkedin.com/in/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">LinkedIn</a>
                
                
                <a href="https://bsky.app/profile/nanxstats.bsky.social" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Bluesky</a>
                
                
                <a href="https://twitter.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Twitter</a>
                
                
                
                <a href="https://nanx.me/colophon/" class="hover:text-accent transition-colors">Colophon</a>
                
                
            </div>

            
            <div class="mt-2">
                © 2026 Nan Xiao. All rights reserved.
            </div>
            
        </div>
    </div>
</footer>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"
        integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/r.min.js" defer></script>
    
    <script>
        window.addEventListener('load', function () {
            hljs.highlightAll();
        }, true);
    </script>
    

    

    
    
    

    
</body>

</html>