<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> Honey, I Serialized the Data - Nan Xiao | 肖楠 </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="Look into the R serialization format in all R releases since 1.9.1." />

    
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="Nan Xiao | 肖楠" />
    <meta property="og:url" content="https://nanx.me/blog/post/r-serialize-timemachine/" />
    <meta property="og:title" content="Honey, I Serialized the Data" />
    <meta property="og:description" content="Look into the R serialization format in all R releases since 1.9.1." />
    <meta property="og:image" content="https://nanx.me/image/alex-o9isBQ25H-g-unsplash.jpg" />
    <meta property="og:image:secure_url" content="https://nanx.me/image/alex-o9isBQ25H-g-unsplash.jpg" />
    <meta property="article:published_time" content="2022-05-01T20:00:00Z" />
    <meta property="article:modified_time" content="2022-05-01T20:00:00Z" />
    <meta property="article:author" content="Nan Xiao" />

    
    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@nanxstats">
    <meta name="twitter:creator" content="@nanxstats">
    
    <meta name="twitter:title" content="Honey, I Serialized the Data" />
    <meta name="twitter:description" content="Look into the R serialization format in all R releases since 1.9.1." />
    <meta name="twitter:image" content="https://nanx.me/image/alex-o9isBQ25H-g-unsplash.jpg" />
    <meta name="twitter:image:alt" content="Honey, I Serialized the Data" />

    
    <meta property="og:linkedin:actor" content="nanxstats" />

    <link rel="canonical" href="https://nanx.me/blog/post/r-serialize-timemachine/">

    
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        serif: ['"Martina Plantijn"', 'Newsreader', 'Georgia', 'Cambria', '"Times New Roman"', 'Times', 'serif'],
                        sans: ['"Instrument Sans"', 'system-ui', '-apple-system', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', 'sans-serif'],
                        mono: ['"Liga Noto Sans Mono"', 'ui-monospace', 'SFMono-Regular', '"SF Mono"', 'Menlo', 'Consolas', 'monospace'],
                    },
                    colors: {
                        paper: '#fdfdfd',
                        ink: '#1c1c1c',
                        accent: '#991b1b',  
                    },
                    typography: {
                        DEFAULT: {
                            css: {
                                maxWidth: 'none',
                                color: '#1c1c1c',
                                '--tw-prose-body': '#1c1c1c',
                                '--tw-prose-headings': '#1c1c1c',
                                '--tw-prose-links': '#991b1b',
                                '--tw-prose-bold': '#111827',
                                '--tw-prose-counters': '#71717a',
                                '--tw-prose-bullets': '#d4d4d8',
                                '--tw-prose-hr': '#e4e4e7',
                                '--tw-prose-quotes': '#1c1c1c',
                                '--tw-prose-quote-borders': '#d4d4d8',
                                '--tw-prose-captions': '#71717a',
                                '--tw-prose-code': '#1c1c1c',
                                '--tw-prose-pre-code': '#1c1c1c',
                                '--tw-prose-pre-bg': '#fdfdfd',
                                '--tw-prose-th-borders': '#d4d4d8',
                                '--tw-prose-td-borders': '#e4e4e7',
                                'pre': {
                                    color: '#1c1c1c',
                                    backgroundColor: '#fdfdfd !important',
                                    border: '1px solid #e4e4e7',
                                },
                                a: {
                                    color: '#991b1b',
                                    textDecoration: 'none',
                                    fontWeight: '400',
                                    borderBottom: '1px solid transparent',
                                    transition: 'border-color 0.2s ease, color 0.2s ease',
                                },
                                'a:hover': {
                                    color: '#991b1b !important',
                                    borderBottomColor: '#991b1b !important',
                                },
                                h1: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em' },
                                h2: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em', marginTop: '2em' },
                                h3: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                h4: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                blockquote: {
                                    fontStyle: 'italic',
                                    fontWeight: '400',
                                    borderLeftWidth: '2px',
                                },
                                'code::before': { content: 'none' },
                                'code::after': { content: 'none' },
                                ':not(pre) > code': {
                                    fontWeight: '400',
                                    color: '#1c1c1c !important',
                                    backgroundColor: '#f4f4f5 !important',
                                    padding: '0.2em 0.4em',
                                    borderRadius: '0.25rem',
                                    fontSize: '0.875em',
                                },
                            },
                        },
                    },
                },
            },
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
            .tufte-grid {
                display: grid;
                grid-template-columns: 1fr min(65ch, 100%) 1fr;
                column-gap: 2rem;
            }
            .tufte-grid > * {
                grid-column: 2;
            }
            .tufte-grid > .full-width {
                grid-column: 1 / -1;
            }
            .tufte-grid > .margin-note {
                grid-column: 3;
                font-family: "Instrument Sans", sans-serif;
                font-size: 0.875rem;
                line-height: 1.4;
                color: #52525b;  
                margin-top: 0.25rem;
            }
            @media (max-width: 1024px) {
                .tufte-grid {
                    grid-template-columns: 1rem 1fr 1rem;
                }
                .tufte-grid > .margin-note {
                    grid-column: 2;
                    margin-top: 0.5rem;
                    margin-bottom: 1rem;
                    padding-left: 1rem;
                    border-left: 2px solid #e4e4e7;
                }
            }
        }
    </style>

    <link rel="stylesheet" href="https://nanx.me/css/custom.css" />

    
    <link rel="stylesheet" href="https://nanx.me/css/textmate.css" />
    

    

    <link rel="shortcut icon"
        href="https://nanx.me/image/favicon.png">

    
</head>

<body class="bg-paper text-ink font-serif antialiased selection:bg-zinc-200">
    
<header class="py-8 lg:py-12 text-sm font-sans tracking-wide max-w-[67ch] mx-auto w-full px-4 sm:px-6">
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 sm:gap-0">
        <a href="https://nanx.me/" class="font-medium text-ink hover:text-accent transition-colors">
            Nan Xiao
        </a>
        <nav class="flex flex-wrap gap-4 sm:gap-6 text-zinc-600">
            
            
            <a class="text-ink font-medium"
                href="https://nanx.me/blog/">
                Blog
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/software/">
                Software
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/papers/">
                Papers
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/talks/">
                Talks
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/books/">
                Books
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/about/">
                About
            </a>
            
        </nav>
    </div>
</header>

<main class="content my-10 lg:my-20 max-w-[65ch] mx-auto w-full px-4 sm:px-6">
    <article>
        <header class="mb-14">
            <h1 class="text-3xl lg:text-4xl font-sans tracking-tight text-ink font-medium mb-4">Honey, I Serialized the Data</h1>

            <div class="text-zinc-500 font-sans text-sm tracking-wide">
                
                
                <span class="author" title="Nan Xiao">
                    Nan Xiao
                </span>
                
                

                <span class="date middot" title='Sun May 1 2022 20:00:00 UTC'>
                    May 1, 2022
                </span>

                <span class="reading-time middot">
                    19 min read
                </span>

                <div class="mt-8 flex flex-wrap gap-2">
                    
                    <a href="https://nanx.me/tags/r"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        R
                    </a>
                    
                    <a href="https://nanx.me/tags/serialization"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        serialization
                    </a>
                    
                    <a href="https://nanx.me/tags/external-data-representation"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        External Data Representation
                    </a>
                    
                    <a href="https://nanx.me/tags/xdr"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        XDR
                    </a>
                    
                    <a href="https://nanx.me/tags/innoextract"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        innoextract
                    </a>
                    
                    
                    
                </div>
            </div>

        </header>

        <div class="prose prose-zinc max-w-none">
            
    


<blockquote>
<p>The R code to reproduce the results in this post is available from
<a href="https://github.com/nanxstats/r-serialize-timemachine" class="uri">https://github.com/nanxstats/r-serialize-timemachine</a>.</p>
</blockquote>
<div class="figure">
<img src="https://nanx.me/image/alex-o9isBQ25H-g-unsplash.jpg" alt="" />
<p class="caption">Photo by <a href="https://unsplash.com/photos/o9isBQ25H-g">Alex Gogan</a>.</p>
</div>
<div id="a-mystery-on-serialize" class="section level2">
<h2>A mystery on serialize()</h2>
<p>Serialization/deserialization is an important topic for exchanging data
efficiently at scale. In R, there is a native choice for this:
<code>serialize()</code>/<code>unserialize()</code> and their more convenient interface
<code>saveRDS()</code>/<code>readRDS()</code>.</p>
<p>Yihui once <a href="https://d.cosx.org/d/419804-serialize-17">asked</a> why the
first 14 bytes in R serialized data were skipped in <code>digest::digest()</code>,
instead of the first 17 bytes for the binary format,
as the additional three filling zero-bytes are always there.</p>
<p>Although there is an entire section in <em>R Internals</em> about
<a href="https://cran.r-project.org/doc/manuals/r-devel/R-ints.html#Serialization-Formats">serialization formats</a>,
I did not find any detailed technical explanations about the bytes in the header.
So I decided to collect more empirical evidence to answer the question.</p>
</div>
<div id="an-unlikely-solution" class="section level2">
<h2>An unlikely solution</h2>
<p>My first assumption is that seeing the same data serialized in different
R versions instead of different data serialized in the same R version
might give us more information.
This is because the non-data-encoding section in the header likely only changes
when the R versions are different, which will make any minor variations
more observable and thus more interpretable.</p>
<p>This solution then becomes a pure automation exercise.
To maximize the number of R versions I can test,
we need to choose the right platform.</p>
<ul>
<li>We should avoid compiling from source because it is almost
impossible to reuse the original toolchains after
so many years. Using compiled R binaries would be our best bet.</li>
<li>To run all the previously compiled R binaries on a single, modern platform,
we will want to choose Windows because it has probably the best
<a href="https://en.wikipedia.org/wiki/Binary-code_compatibility">ABI compatibility</a>
among the common platforms.</li>
</ul>
<p>It eventually took ~130 lines of R code to accomplish this automation.
The project is available at
<a href="https://github.com/nanxstats/r-serialize-timemachine" class="uri">https://github.com/nanxstats/r-serialize-timemachine</a>.
You can click the button below to view the serialization results.</p>
<details>
<summary>
<strong>Click here to expand the table</strong>
</summary>
<!-- <https://yihui.org/en/2021/06/css-full-width/> -->
<style type="text/css">
.fullwidth table {
    max-width: none;
    width: 100vw;
    margin-left: calc(50% - 50vw);
    font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo,
        Consolas, "Liberation Mono", monospace;
    font-size: 0.875rem;
}

details > summary {
    border: 1px solid #6c757d;
    border-radius: 0.25rem;
    padding: 1rem;
}
</style>
<div class="fullwidth">
<table class="table table-sm table-striped table-hover">
<thead>
<tr>
<th style="text-align:left;">
R Version
</th>
<th style="text-align:left;">
Hex value of serialized "ABCDEF"
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1.9.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 01 09 01 00 01 04 00 00 00 04 10 00 00 00 01 00 00 04 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.0.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 00 00 00 01 04 00 00 00 04 10 00 00 00 01 00 00 04 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.0.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 00 01 00 01 04 00 00 00 04 10 00 00 00 01 00 00 04 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.1.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 01 00 00 01 04 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.1.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 01 01 00 01 04 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.2.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 02 00 00 01 04 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.2.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 02 01 00 01 04 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.3.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 03 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.3.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 03 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.4.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 04 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.4.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 04 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.5.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 05 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.5.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 05 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.6.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 06 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.6.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 06 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.6.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 06 02 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.7.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 07 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.7.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 07 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.7.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 07 02 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.8.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 08 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.8.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 08 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.9.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 09 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.9.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 09 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.9.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 09 02 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.10.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0a 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.10.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0a 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.11.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0b 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.11.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0b 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.12.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0c 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.12.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0c 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.12.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0c 02 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.13.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0d 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.13.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0d 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.13.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0d 02 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.14.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0e 00 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.14.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0e 01 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.14.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0e 02 00 02 03 00 00 00 00 10 00 00 00 01 00 00 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.15.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0f 00 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.15.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0f 01 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.15.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0f 02 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
2.15.3
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 02 0f 03 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.0.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 00 00 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.0.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 00 01 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.0.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 00 02 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.0.3
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 00 03 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.1.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 01 00 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.1.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 01 01 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.1.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 01 02 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.1.3
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 01 03 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.2.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 02 00 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.2.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 02 01 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.2.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 02 02 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.2.3
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 02 03 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.2.4
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 02 04 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.2.5
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 02 05 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.3.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 03 00 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.3.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 03 01 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.3.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 03 02 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.3.3
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 03 03 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.4.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 04 00 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.4.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 04 01 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.4.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 04 02 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.4.3
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 04 03 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.4.4
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 04 04 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.5.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 05 00 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.5.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 05 01 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.5.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 05 02 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.5.3
</td>
<td style="text-align:left;">
58 0a 00 00 00 02 00 03 05 03 00 02 03 00 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.6.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 03 06 00 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.6.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 03 06 01 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.6.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 03 06 02 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
3.6.3
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 03 06 03 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
4.0.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 04 00 00 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
4.0.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 04 00 01 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
4.0.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 04 00 02 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
4.0.3
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 04 00 03 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
4.0.4
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 04 00 04 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
4.0.5
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 04 00 05 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
4.1.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 04 01 00 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
4.1.1
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 04 01 01 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
4.1.2
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 04 01 02 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
4.1.3
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 04 01 03 00 03 05 00 00 00 00 06 43 50 31 32 35 32 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
<tr>
<td style="text-align:left;">
4.2.0
</td>
<td style="text-align:left;">
58 0a 00 00 00 03 00 04 02 00 00 03 05 00 00 00 00 05 55 54 46 2d 38 00 00 00 10 00 00 00 01 00 04 00 09 00 00 00 06 41 42 43 44 45 46
</td>
</tr>
</tbody>
</table>
</div>
</details>
<p>
</p>
</div>
<div id="an-evolving-language" class="section level2">
<h2>An evolving language</h2>
<p>From this small window, we can have a glimpse at how the infrastructure in R
evolved in the last 20 years, tracing from the earliest release we can test
(R 1.9.1, released in 2004):</p>
<ul>
<li>The differences in the serialized data since R 3.6.0 are apparent.
If you still remember, it was because the
<a href="https://cran.r-project.org/doc/manuals/r-release/NEWS.3.html#:~:text=CHANGES%20IN%20R%203.6.0">serialization format version 3 became the default</a>,
although it has already existed since R 3.5.0.</li>
<li>There are notable differences in R 4.2.0, although still using serialization
format version 3. Perhaps this is related to the
<a href="https://developer.r-project.org/Blog/public/2021/12/07/upcoming-changes-in-r-4.2-on-windows/">UCRT update</a>?</li>
<li><code>serialize()</code> return value. We cannot use <code>serialize(connection = NULL)</code>
as our test payload directly since <a href="https://cran-archive.r-project.org/bin/windows/base/old/2.4.0/NEWS.R-2.4.0">it returned a character string</a>
instead of a raw vector until R 2.4.0.
Therefore, we used the higher-level function <code>saveRDS()</code>
as a proxy to get the outputs.</li>
<li><code>saveRDS()</code> compression option. For our purpose of cross-version comparison,
we set <code>saveRDS(compress = FALSE)</code> because the default of <code>compress</code> was
flipped to <code>TRUE</code> since R 2.4.0.</li>
<li><code>saveRDS()</code> was called <code>.saveRDS()</code> before R 2.13.0.</li>
<li><code>Rscript.exe</code> did not exist until R 2.5.0. Therefore, we used <code>Rcmd.exe</code>
instead in the earlier versions.</li>
</ul>
<p>I think these are all very positive language and tooling improvements—which
benefit all R developers every day!
The consistency and compatibility in other aspects are also amazingly high.
If we don’t remove each R version after they are extracted into <code>dist/</code>,
you can open them and run every <code>app/bin/Rgui.exe</code> on the latest
Windows 10 without issues.</p>
</div>
<div id="a-possible-answer" class="section level2">
<h2>A possible answer</h2>
<p>Here is my answer to the original question on why the skipping offset
should be 14 instead of 17.</p>
<p>From the table above, there are many <code>00</code> as zero-bytes of fills.
So naturally, it is critical to know how these filler bytes are used.
If we look into the <code>serialize()</code> upstream serialization format
<a href="https://en.wikipedia.org/wiki/External_Data_Representation">XDR</a>,
its corresponding RFC 1832 offers an informative
<a href="https://datatracker.ietf.org/doc/html/rfc1832#section-6">example</a>
and some
<a href="https://datatracker.ietf.org/doc/html/rfc1832#section-2">clues</a>:</p>
<blockquote>
<p><strong>BASIC BLOCK SIZE</strong></p>
<p>The representation of all items requires a multiple of four bytes (or 32 bits) of data.
… If the n bytes needed to contain the data are not
a multiple of four, then the n bytes are followed by enough (0 to 3)
residual zero bytes, r, to make the total byte count a multiple of 4.</p>
</blockquote>
<p>Using R 4.2.0 as an example, the serialized <code>"ABCDEF"</code> is:</p>
<pre class="text"><code>58 0a
00 00 00 03
00 04 02 00
00 03 05 00
00 00 00 05
...</code></pre>
<p>We can annotate it like this:</p>
<pre class="text"><code>OFFSET      HEX BYTES       ASCII    COMMENTS
------      ---------       -----    --------
     0      58 0a           X\n      -- X (XDR format) and line break
     2      00 00 00 03     ...3     -- serialization format version = 3
     6      00 04 02 00     .420     -- current R version = 4.2.0
    10      00 03 05 00     .350     -- format available since 3.5.0
    14      00 00 00 05     ...5     -- serialized data starting</code></pre>
<p>This is a rough hypothesis, and I could be wrong.
So, don’t be shy and leave a comment to add the correct explanation.</p>
</div>



        </div>

        
        <nav class="pagination-nav mt-10 mb-3" aria-label="Blog post navigation">
            <div class="navigation-btns">
                
                <a href="https://nanx.me/blog/post/shiny-loading-skeleton/" class="btn-nav btn-prev w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Previous</div>
                        <div class="pagination-nav-label">&laquo; Five Minute Shiny: Skeleton Loading Screen</div>
                    </div>
                </a>
                

                
                <a href="https://nanx.me/blog/post/sensible-defaults/" class="btn-nav btn-next w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Next</div>
                        <div class="pagination-nav-label">Sensible Defaults &raquo;</div>
                    </div>
                </a>
                
            </div>
        </nav>
        

    </article>
</main>

<section id="comments">
    <div class="py-3 content">
        <div class="mx-auto max-w-[65ch] w-full px-4 sm:px-6">
            <div class="comments">
                <script src="https://utteranc.es/client.js" repo="nanxstats/blog-comments" issue-term="pathname"
                    label="comment" theme="github-light" crossorigin="anonymous" async>
                    </script>
            </div>
        </div>
    </div>
</section>
<footer class="mt-20 mb-10 text-center font-sans text-sm text-zinc-500 tracking-wide">
    <div class="tufte-grid">
        <div class="flex flex-col items-center gap-4">
            <div class="flex flex-wrap items-center justify-center gap-x-4 gap-y-2">
                
                
                <a href="https://github.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">GitHub</a>
                
                
                
                
                <a href="https://www.linkedin.com/in/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">LinkedIn</a>
                
                
                <a href="https://bsky.app/profile/nanxstats.bsky.social" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Bluesky</a>
                
                
                <a href="https://twitter.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Twitter</a>
                
                
                
                <a href="https://nanx.me/colophon/" class="hover:text-accent transition-colors">Colophon</a>
                
                
            </div>

            
            <div class="mt-2">
                © 2026 Nan Xiao. All rights reserved.
            </div>
            
        </div>
    </div>
</footer>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"
        integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/r.min.js" defer></script>
    
    <script>
        window.addEventListener('load', function () {
            hljs.highlightAll();
        }, true);
    </script>
    

    

    
    
    
<script src="https://nanx.me/js/math-code.js"></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
</body>

</html>