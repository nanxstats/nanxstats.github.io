<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> protr 1.7-0 - Nan Xiao | 肖楠 </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="protr 1.7-0 brings new tools for parallel protein sequence similarity computation between two sets of proteins based on sequence alignment.
" />

    
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="Nan Xiao | 肖楠" />
    <meta property="og:url" content="https://nanx.me/blog/post/protr-1-7-0/" />
    <meta property="og:title" content="protr 1.7-0" />
    <meta property="og:description" content="protr 1.7-0 brings new tools for parallel protein sequence similarity computation between two sets of proteins based on sequence alignment.
" />
    <meta property="og:image" content="https://nanx.me/image/google-deepmind-Fv39DqWqtHw-unsplash.jpg" />
    <meta property="og:image:secure_url" content="https://nanx.me/image/google-deepmind-Fv39DqWqtHw-unsplash.jpg" />
    <meta property="article:published_time" content="2023-11-10T21:00:00Z" />
    <meta property="article:modified_time" content="2023-11-10T21:00:00Z" />
    <meta property="article:author" content="Nan Xiao" />

    
    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@nanxstats">
    <meta name="twitter:creator" content="@nanxstats">
    
    <meta name="twitter:title" content="protr 1.7-0" />
    <meta name="twitter:description" content="protr 1.7-0 brings new tools for parallel protein sequence similarity computation between two sets of proteins based on sequence alignment.
" />
    <meta name="twitter:image" content="https://nanx.me/image/google-deepmind-Fv39DqWqtHw-unsplash.jpg" />
    <meta name="twitter:image:alt" content="protr 1.7-0" />

    
    <meta property="og:linkedin:actor" content="nanxstats" />

    <link rel="canonical" href="https://nanx.me/blog/post/protr-1-7-0/">

    
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        serif: ['"Martina Plantijn"', 'Newsreader', 'Georgia', 'Cambria', '"Times New Roman"', 'Times', 'serif'],
                        sans: ['"Instrument Sans"', 'system-ui', '-apple-system', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', 'sans-serif'],
                        mono: ['"Liga Noto Sans Mono"', 'ui-monospace', 'SFMono-Regular', '"SF Mono"', 'Menlo', 'Consolas', 'monospace'],
                    },
                    colors: {
                        paper: '#fdfdfd',
                        ink: '#1c1c1c',
                        accent: '#991b1b',  
                    },
                    typography: {
                        DEFAULT: {
                            css: {
                                maxWidth: 'none',
                                color: '#1c1c1c',
                                '--tw-prose-body': '#1c1c1c',
                                '--tw-prose-headings': '#1c1c1c',
                                '--tw-prose-links': '#991b1b',
                                '--tw-prose-bold': '#111827',
                                '--tw-prose-counters': '#71717a',
                                '--tw-prose-bullets': '#d4d4d8',
                                '--tw-prose-hr': '#e4e4e7',
                                '--tw-prose-quotes': '#1c1c1c',
                                '--tw-prose-quote-borders': '#d4d4d8',
                                '--tw-prose-captions': '#71717a',
                                '--tw-prose-code': '#1c1c1c',
                                '--tw-prose-pre-code': '#1c1c1c',
                                '--tw-prose-pre-bg': '#fdfdfd',
                                '--tw-prose-th-borders': '#d4d4d8',
                                '--tw-prose-td-borders': '#e4e4e7',
                                'pre': {
                                    color: '#1c1c1c',
                                    backgroundColor: '#fdfdfd !important',
                                    border: '1px solid #e4e4e7',
                                },
                                a: {
                                    color: '#991b1b',
                                    textDecoration: 'none',
                                    fontWeight: '400',
                                    borderBottom: '1px solid transparent',
                                    transition: 'border-color 0.2s ease, color 0.2s ease',
                                },
                                'a:hover': {
                                    color: '#991b1b !important',
                                    borderBottomColor: '#991b1b !important',
                                },
                                h1: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em' },
                                h2: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em', marginTop: '2em' },
                                h3: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                h4: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                blockquote: {
                                    fontStyle: 'italic',
                                    fontWeight: '400',
                                    borderLeftWidth: '2px',
                                },
                                'code::before': { content: 'none' },
                                'code::after': { content: 'none' },
                                ':not(pre) > code': {
                                    fontWeight: '400',
                                    color: '#1c1c1c !important',
                                    backgroundColor: '#f4f4f5 !important',
                                    padding: '0.2em 0.4em',
                                    borderRadius: '0.25rem',
                                    fontSize: '0.875em',
                                },
                            },
                        },
                    },
                },
            },
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
            .tufte-grid {
                display: grid;
                grid-template-columns: 1fr min(65ch, 100%) 1fr;
                column-gap: 2rem;
            }
            .tufte-grid > * {
                grid-column: 2;
            }
            .tufte-grid > .full-width {
                grid-column: 1 / -1;
            }
            .tufte-grid > .margin-note {
                grid-column: 3;
                font-family: "Instrument Sans", sans-serif;
                font-size: 0.875rem;
                line-height: 1.4;
                color: #52525b;  
                margin-top: 0.25rem;
            }
            @media (max-width: 1024px) {
                .tufte-grid {
                    grid-template-columns: 1rem 1fr 1rem;
                }
                .tufte-grid > .margin-note {
                    grid-column: 2;
                    margin-top: 0.5rem;
                    margin-bottom: 1rem;
                    padding-left: 1rem;
                    border-left: 2px solid #e4e4e7;
                }
            }
        }
    </style>

    <link rel="stylesheet" href="https://nanx.me/css/custom.css" />

    
    <link rel="stylesheet" href="https://nanx.me/css/textmate.css" />
    

    

    <link rel="shortcut icon"
        href="https://nanx.me/image/favicon.png">

    
</head>

<body class="bg-paper text-ink font-serif antialiased selection:bg-zinc-200">
    
<header class="py-8 lg:py-12 text-sm font-sans tracking-wide max-w-[67ch] mx-auto w-full px-4 sm:px-6">
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 sm:gap-0">
        <a href="https://nanx.me/" class="font-medium text-ink hover:text-accent transition-colors">
            Nan Xiao
        </a>
        <nav class="flex flex-wrap gap-4 sm:gap-6 text-zinc-600">
            
            
            <a class="text-ink font-medium"
                href="https://nanx.me/blog/">
                Blog
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/software/">
                Software
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/papers/">
                Papers
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/talks/">
                Talks
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/books/">
                Books
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/about/">
                About
            </a>
            
        </nav>
    </div>
</header>

<main class="content my-10 lg:my-20 max-w-[65ch] mx-auto w-full px-4 sm:px-6">
    <article>
        <header class="mb-14">
            <h1 class="text-3xl lg:text-4xl font-sans tracking-tight text-ink font-medium mb-4">protr 1.7-0</h1>

            <div class="text-zinc-500 font-sans text-sm tracking-wide">
                
                
                <span class="author" title="Nan Xiao">
                    Nan Xiao
                </span>
                
                

                <span class="date middot" title='Fri Nov 10 2023 21:00:00 UTC'>
                    November 10, 2023
                </span>

                <span class="reading-time middot">
                    3 min read
                </span>

                <div class="mt-8 flex flex-wrap gap-2">
                    
                    <a href="https://nanx.me/tags/r"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        R
                    </a>
                    
                    <a href="https://nanx.me/tags/r-packages"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        R packages
                    </a>
                    
                    <a href="https://nanx.me/tags/protein-sequence"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        protein sequence
                    </a>
                    
                    <a href="https://nanx.me/tags/feature-engineering"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        feature engineering
                    </a>
                    
                    
                    
                </div>
            </div>

        </header>

        <div class="prose prose-zinc max-w-none">
            
    


<div class="float">
<img src="https://nanx.me/image/google-deepmind-Fv39DqWqtHw-unsplash.jpg" alt="3D render from Google DeepMind. Artist: Wes Cockx." />
<div class="figcaption">3D render from <a href="https://unsplash.com/photos/a-model-of-a-building-made-out-of-legos-Fv39DqWqtHw">Google DeepMind</a>. Artist: Wes Cockx.</div>
</div>
<p>I am glad to announce the release of <a href="https://nanx.me/protr/">protr</a> 1.7-0.
Install it from CRAN with:</p>
<pre class="r"><code>install.packages(&quot;protr&quot;)</code></pre>
<p>You can also install it from
<a href="https://anaconda.org/conda-forge/r-protr">conda-forge</a> in Python.</p>
<p>First released in 2012, protr was my very first open source R package.
The package generates representations for protein sequences such as
numerical features and similarity measures.
Since its inception, protr has evolved after 21 CRAN releases
by incorporating user feedback. With 296 Google Scholar
<a href="https://scholar.google.com/scholar?cites=14211153676111619910">citations</a>
as of November 2023, it has demonstrated to be a useful
component for many workflows in drug discovery and machine learning research.</p>
<div id="whats-new" class="section level2">
<h2>What’s new</h2>
<p>A simple but common task in computational biology is to compute similarities
between proteins based on their sequences. The capability to compute such
similarities efficiently is essential for research in drug discovery,
protein-protein interaction prediction, and biomarker identification, providing
a foundation for kernel-based machine learning and deep learning methods.</p>
<p>protr 1.7-0 adds a new function
<a href="https://nanx.me/protr/reference/crossSetSim.html"><code>crossSetSim()</code></a>
for computing sequence-derived similarity (using multiple sequence alignment)
for all combinations of <span class="math inline">\(m \times n\)</span> sequences from two protein sets of
size <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span>. Here is an example:</p>
<pre class="r"><code>library(protr)

# Find example UniProt FASTA files
fasta_files &lt;- list.files(
  system.file(&quot;protseq&quot;, package = &quot;protr&quot;),
  pattern = &quot;^[A-Z][0-9][A-Z0-9]{3}[0-9]\\.fasta$&quot;,
  full.names = TRUE
)

# Select 10 and 500 FASTA files for the two protein sets
set.seed(42)
protein_set_1 &lt;- sample(fasta_files, size = 10, replace = TRUE)
protein_set_2 &lt;- sample(fasta_files, size = 500, replace = TRUE)

# Read sequences from the FASTA files for both protein sets
seq_set_1 &lt;- sapply(protein_set_1, readFASTA, USE.NAMES = FALSE)
seq_set_2 &lt;- sapply(protein_set_2, readFASTA, USE.NAMES = FALSE)

# Compute the similarity between the two sets of protein sequences in parallel
seq_sim &lt;- crossSetSim(seq_set_1, seq_set_2, cores = 8)

# Set the column and row names of the similarity matrix to proteins names
colnames(seq_sim) &lt;- names(seq_set_1)
rownames(seq_sim) &lt;- names(seq_set_2)

# Preview the similarity matrix
head(seq_sim)[, 1:2]</code></pre>
<p>This function extends the existing functions for computing pairwise
similarities within a single set of proteins.
The API is made consistent with the previous implementations,
using foreach and doParallel for parallelization.</p>
<p>With the advancements in modern R parallel computing infrastructure,
particularly in futureverse, these functions should be ideally written in
a parallel backend agnostic style using <code>%dofuture%</code> so the parallel context
can be configured in user land code and any available backend types can be used.
See the articles linked in <a href="https://github.com/nanxstats/r-future-recipes">nanxstats/r-future-recipes</a>
for more details.</p>
</div>
<div id="relevant-tools-for-sequence-similarity-in-protr" class="section level2">
<h2>Relevant tools for sequence similarity in protr</h2>
<p>In protr, two functions for computing pairwise similarity within
a single list of protein sequences are the most frequently used:</p>
<ul>
<li><a href="https://nanx.me/protr/reference/parSeqSim.html"><code>parSeqSim()</code></a> -
Computes the <span class="math inline">\(n^2/2 - n\)</span> pairwise similarities within a single
protein sequence set of size <span class="math inline">\(n\)</span> in parallel.
Our <a href="https://doi.org/10.1002/psp4.12002">multiple evidence fusion paper</a>
published in 2015 leveraged this similarity information to generate
features inspired by collaborative filtering for a classification algorithm.</li>
<li><a href="https://nanx.me/protr/reference/parSeqSimDisk.html"><code>parSeqSimDisk()</code></a> -
Sometimes, the sequence data and similarity matrices are too large
to fit into RAM—especially when in parallel.
This is a memory-aware version that splits the task into batches,
writes the results in each batch to disk, and eventually merges the
cached results together.</li>
</ul>
</div>
<div id="acknowledgments" class="section level2">
<h2>Acknowledgments</h2>
<p>I want to thank <a href="https://github.com/seb-mueller">Sebastian Mueller</a>
for raising the need and contributing the code
(<a href="https://github.com/nanxstats/protr/issues/34">nanxstats/protr#34</a>).
Also, a big shout out to the user community and
package developers (3 reverse imports) for your continued trust and support.</p>
</div>



        </div>

        
        <nav class="pagination-nav mt-10 mb-3" aria-label="Blog post navigation">
            <div class="navigation-btns">
                
                <a href="https://nanx.me/blog/post/nine-questions-about-adaptive-design/" class="btn-nav btn-prev w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Previous</div>
                        <div class="pagination-nav-label">&laquo; 9 Questions About Adaptive Design</div>
                    </div>
                </a>
                

                
                <a href="https://nanx.me/blog/post/stixfonts/" class="btn-nav btn-next w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Next</div>
                        <div class="pagination-nav-label">Use STIX Fonts in R Markdown and Quarto for Readability &raquo;</div>
                    </div>
                </a>
                
            </div>
        </nav>
        

    </article>
</main>

<section id="comments">
    <div class="py-3 content">
        <div class="mx-auto max-w-[65ch] w-full px-4 sm:px-6">
            <div class="comments">
                <script src="https://utteranc.es/client.js" repo="nanxstats/blog-comments" issue-term="pathname"
                    label="comment" theme="github-light" crossorigin="anonymous" async>
                    </script>
            </div>
        </div>
    </div>
</section>
<footer class="mt-20 mb-10 text-center font-sans text-sm text-zinc-500 tracking-wide">
    <div class="tufte-grid">
        <div class="flex flex-col items-center gap-4">
            <div class="flex flex-wrap items-center justify-center gap-x-4 gap-y-2">
                
                
                <a href="https://github.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">GitHub</a>
                
                
                
                
                <a href="https://www.linkedin.com/in/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">LinkedIn</a>
                
                
                <a href="https://bsky.app/profile/nanxstats.bsky.social" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Bluesky</a>
                
                
                <a href="https://twitter.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Twitter</a>
                
                
                
                <a href="https://nanx.me/colophon/" class="hover:text-accent transition-colors">Colophon</a>
                
                
            </div>

            
            <div class="mt-2">
                © 2026 Nan Xiao. All rights reserved.
            </div>
            
        </div>
    </div>
</footer>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"
        integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/r.min.js" defer></script>
    
    <script>
        window.addEventListener('load', function () {
            hljs.highlightAll();
        }, true);
    </script>
    

    

    
    
    
<script src="https://nanx.me/js/math-code.js"></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
</body>

</html>