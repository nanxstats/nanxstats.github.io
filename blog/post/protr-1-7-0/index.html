<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> protr 1.7-0 - Nan Xiao | 肖楠 </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="protr 1.7-0 brings new tools for parallel protein sequence similarity computation between two sets of proteins based on sequence alignment.
" />
    <meta property="og:site_name" content="Nan Xiao | 肖楠" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://nanx.me/blog/post/protr-1-7-0/" />
    <meta property="og:title" content="protr 1.7-0" />
    <meta property="og:image" content="https://nanx.me/image/google-deepmind-Fv39DqWqtHw-unsplash.jpg" />
    <meta property="og:description" content="protr 1.7-0 brings new tools for parallel protein sequence similarity computation between two sets of proteins based on sequence alignment.
" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@nanxstats">
    <meta name="twitter:creator" content="@nanxstats">
    
    <meta name="twitter:title" content="protr 1.7-0" />
    <meta name="twitter:description" content="protr 1.7-0 brings new tools for parallel protein sequence similarity computation between two sets of proteins based on sequence alignment.
" />
    <meta name="twitter:image" content="https://nanx.me/image/google-deepmind-Fv39DqWqtHw-unsplash.jpg" />

    <link rel="canonical" href="https://nanx.me/blog/post/protr-1-7-0/">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" integrity="sha512-b2QcS5SsA8tZodcDtGRELiGv5SaKSk1vDHDaQRda0htPYWZ6046lr3kJ5bAAQdpV2mmA/4v0wQF9MyU6/pDIAg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="https://nanx.me/css/custom.css" />

    
    <link rel="stylesheet" href="https://nanx.me/css/textmate.css" />
    

    

    <link rel="shortcut icon"
        href="https://nanx.me/image/favicon.png">

    
</head>

<body>
    
<div class="my-4 my-lg-5 header">
    <div class="container">
        <div class="row justify-content-center">
            <div class="mx-auto w-700">
                <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                        
                        <a href="https://nanx.me/">
                            <img class="logo img-fluid d-block rounded-circle img-thumbnail shadow-sm"
                                src="https://nanx.me/image/nanxiao.jpg" alt="Portrait of Nan Xiao">
                        </a>
                        
                    </div>
                    <div class="flex-grow-1 ms-3">
                        <a href="https://nanx.me/">
                            <h1 class="name">Nan Xiao</h1>
                        </a>

                        <ul class="nav nav-primary">
                            
                            
                            <li class="nav-item">
                                <a class="nav-link text-blog active"
                                    href="https://nanx.me/blog/">
                                    
                                    Blog
                                </a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link text-software"
                                    href="https://nanx.me/software/">
                                    
                                    Software
                                </a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link text-papers"
                                    href="https://nanx.me/papers/">
                                    
                                    Papers
                                </a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link text-talks"
                                    href="https://nanx.me/talks/">
                                    
                                    Talks
                                </a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link text-books"
                                    href="https://nanx.me/books/">
                                    
                                    Books
                                </a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link text-about"
                                    href="https://nanx.me/about/">
                                    
                                    About
                                </a>
                            </li>
                            
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="content">
    <div class="container">
        <div class="row justify-content-center">
            <div class="mx-auto w-700">
                <h1 class="blog-post-title">protr 1.7-0</h1>

                <div class="mb-md-4 meta">
                    
                    
                    <span class="author" title="Nan Xiao">
                        Nan Xiao
                    </span>
                    
                    

                    <span class="date middot" title='Fri Nov 10 2023 21:00:00 UTC'>
                        November 10, 2023
                    </span>

                    <span class="reading-time middot">
                        3 min read
                    </span>

                    <div class="d-none d-md-block mt-2 tags">
                        <ul class="list-unstyled d-inline">
                            
                            <li class="d-inline">
                                <a href="https://nanx.me/tags/r">R</a>
                            </li>
                            
                            <li class="d-inline">
                                <a href="https://nanx.me/tags/r-packages">R packages</a>
                            </li>
                            
                            <li class="d-inline">
                                <a href="https://nanx.me/tags/protein-sequence">protein sequence</a>
                            </li>
                            
                            <li class="d-inline">
                                <a href="https://nanx.me/tags/feature-engineering">feature engineering</a>
                            </li>
                            
                        </ul>
                    </div>

                    <div class="d-none d-md-inline tags">
                        <ul class="list-unstyled d-inline">
                            
                            
                        </ul>
                    </div>
                </div>

                <div class="markdown blog-post-content">
                    
    


<div class="float">
<img src="https://nanx.me/image/google-deepmind-Fv39DqWqtHw-unsplash.jpg" alt="3D render from Google DeepMind. Artist: Wes Cockx." />
<div class="figcaption">3D render from <a href="https://unsplash.com/photos/a-model-of-a-building-made-out-of-legos-Fv39DqWqtHw">Google DeepMind</a>. Artist: Wes Cockx.</div>
</div>
<p>I am glad to announce the release of <a href="https://nanx.me/protr/">protr</a> 1.7-0.
Install it from CRAN with:</p>
<pre class="r"><code>install.packages(&quot;protr&quot;)</code></pre>
<p>You can also install it from
<a href="https://anaconda.org/conda-forge/r-protr">conda-forge</a> in Python.</p>
<p>First released in 2012, protr was my very first open source R package.
The package generates representations for protein sequences such as
numerical features and similarity measures.
Since its inception, protr has evolved after 21 CRAN releases
by incorporating user feedback. With 296 Google Scholar
<a href="https://scholar.google.com/scholar?cites=14211153676111619910">citations</a>
as of November 2023, it has demonstrated to be a useful
component for many workflows in drug discovery and machine learning research.</p>
<div id="whats-new" class="section level2">
<h2>What’s new</h2>
<p>A simple but common task in computational biology is to compute similarities
between proteins based on their sequences. The capability to compute such
similarities efficiently is essential for research in drug discovery,
protein-protein interaction prediction, and biomarker identification, providing
a foundation for kernel-based machine learning and deep learning methods.</p>
<p>protr 1.7-0 adds a new function
<a href="https://nanx.me/protr/reference/crossSetSim.html"><code>crossSetSim()</code></a>
for computing sequence-derived similarity (using multiple sequence alignment)
for all combinations of <span class="math inline">\(m \times n\)</span> sequences from two protein sets of
size <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span>. Here is an example:</p>
<pre class="r"><code>library(protr)

# Find example UniProt FASTA files
fasta_files &lt;- list.files(
  system.file(&quot;protseq&quot;, package = &quot;protr&quot;),
  pattern = &quot;^[A-Z][0-9][A-Z0-9]{3}[0-9]\\.fasta$&quot;,
  full.names = TRUE
)

# Select 10 and 500 FASTA files for the two protein sets
set.seed(42)
protein_set_1 &lt;- sample(fasta_files, size = 10, replace = TRUE)
protein_set_2 &lt;- sample(fasta_files, size = 500, replace = TRUE)

# Read sequences from the FASTA files for both protein sets
seq_set_1 &lt;- sapply(protein_set_1, readFASTA, USE.NAMES = FALSE)
seq_set_2 &lt;- sapply(protein_set_2, readFASTA, USE.NAMES = FALSE)

# Compute the similarity between the two sets of protein sequences in parallel
seq_sim &lt;- crossSetSim(seq_set_1, seq_set_2, cores = 8)

# Set the column and row names of the similarity matrix to proteins names
colnames(seq_sim) &lt;- names(seq_set_1)
rownames(seq_sim) &lt;- names(seq_set_2)

# Preview the similarity matrix
head(seq_sim)[, 1:2]</code></pre>
<p>This function extends the existing functions for computing pairwise
similarities within a single set of proteins.
The API is made consistent with the previous implementations,
using foreach and doParallel for parallelization.</p>
<p>With the advancements in modern R parallel computing infrastructure,
particularly in futureverse, these functions should be ideally written in
a parallel backend agnostic style using <code>%dofuture%</code> so the parallel context
can be configured in user land code and any available backend types can be used.
See the articles linked in <a href="https://github.com/nanxstats/r-future-recipes">nanxstats/r-future-recipes</a>
for more details.</p>
</div>
<div id="relevant-tools-for-sequence-similarity-in-protr" class="section level2">
<h2>Relevant tools for sequence similarity in protr</h2>
<p>In protr, two functions for computing pairwise similarity within
a single list of protein sequences are the most frequently used:</p>
<ul>
<li><a href="https://nanx.me/protr/reference/parSeqSim.html"><code>parSeqSim()</code></a> -
Computes the <span class="math inline">\(n^2/2 - n\)</span> pairwise similarities within a single
protein sequence set of size <span class="math inline">\(n\)</span> in parallel.
Our <a href="https://doi.org/10.1002/psp4.12002">multiple evidence fusion paper</a>
published in 2015 leveraged this similarity information to generate
features inspired by collaborative filtering for a classification algorithm.</li>
<li><a href="https://nanx.me/protr/reference/parSeqSimDisk.html"><code>parSeqSimDisk()</code></a> -
Sometimes, the sequence data and similarity matrices are too large
to fit into RAM—especially when in parallel.
This is a memory-aware version that splits the task into batches,
writes the results in each batch to disk, and eventually merges the
cached results together.</li>
</ul>
</div>
<div id="acknowledgments" class="section level2">
<h2>Acknowledgments</h2>
<p>I want to thank <a href="https://github.com/seb-mueller">Sebastian Mueller</a>
for raising the need and contributing the code
(<a href="https://github.com/nanxstats/protr/issues/34">nanxstats/protr#34</a>).
Also, a big shout out to the user community and
package developers (3 reverse imports) for your continued trust and support.</p>
</div>



                </div>

                
                <nav class="pagination-nav mt-4 mb-3" aria-label="Blog post navigation">
                    <div class="row navigation-btns">
                        <div class="col">
                            
                            <a href="https://nanx.me/blog/post/nine-questions-about-adaptive-design/" class="btn btn-outline-nav btn-equal-height btn-prev w-100">
                                <div class="btn-content">
                                    <div class="pagination-nav-sublabel">Previous</div>
                                    <div class="pagination-nav-label">« 9 Questions About Adaptive Design</div>
                                </div>
                            </a>
                            
                        </div>

                        <div class="col">
                            
                            <a href="https://nanx.me/blog/post/stixfonts/" class="btn btn-outline-nav btn-equal-height btn-next w-100">
                                <div class="btn-content">
                                    <div class="pagination-nav-sublabel">Next</div>
                                    <div class="pagination-nav-label">Use STIX Fonts in R Markdown and Quarto for Readability »</div>
                                </div>
                            </a>
                            
                        </div>
                    </div>
                </nav>
                

            </div>
        </div>
    </div>
</div>

<section id="comments">
    <div class="py-3 content">
        <div class="container">
            <div class="row justify-content-center">
                <div class="mx-auto w-700">
                    <div class="comments">
                        <script src="https://utteranc.es/client.js" repo="nanxstats/blog-comments"
                            issue-term="pathname" label="comment" theme="github-light" crossorigin="anonymous" async>
                            </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<div class="footer mt-5">
    <div class="container">

        <div class="row justify-content-center">
            <div class="mx-auto w-700">
                <hr>
            </div>
        </div>

        <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
            <symbol id="github" viewBox="0 0 16 16">
                <path
                    d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" />
            </symbol>
            <symbol id="linkedin" viewBox="0 0 16 16">
                <path
                    d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z" />
            </symbol>
            <symbol id="twitter" viewBox="0 0 16 16">
                <path
                    d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z" />
            </symbol>
            <symbol id="mastodon" viewBox="0 0 16 16">
                <path
                    d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a3.614 3.614 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522c0-.859.22-1.541.66-2.046.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764.442.505.661 1.187.661 2.046v4.203z" />
            </symbol>
            <symbol id="octicons-rss" viewBox="0 0 16 16">
                <path
                    d="M2.002 2.725a.75.75 0 0 1 .797-.699C8.79 2.42 13.58 7.21 13.974 13.201a.75.75 0 0 1-1.497.098 10.502 10.502 0 0 0-9.776-9.776.747.747 0 0 1-.7-.798ZM2.84 7.05h-.002a7.002 7.002 0 0 1 6.113 6.111.75.75 0 0 1-1.49.178 5.503 5.503 0 0 0-4.8-4.8.75.75 0 0 1 .179-1.489ZM2 13a1 1 0 1 1 2 0 1 1 0 0 1-2 0Z">
                </path>
            </symbol>
            <symbol id="octicons-terminal" viewBox="0 0 16 16">
                <path
                    d="M0 2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75v10.5A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25Zm1.75-.25a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25ZM7.25 8a.749.749 0 0 1-.22.53l-2.25 2.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L5.44 8 3.72 6.28a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l2.25 2.25c.141.14.22.331.22.53Zm1.5 1.5h3a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5Z">
                </path>
            </symbol>
        </svg>

        <div class="row justify-content-center">
            <div class="mx-auto w-700">
                
                <div class="site-copyright">
                    © 2024 Nan Xiao. All rights reserved.
                </div>
                
            </div>
        </div>
        <div class="row justify-content-center mt-2 mb-5">
            <div class="mx-auto w-700">
                <div class="social-links">
                    <ul>
                        

                        
                        <li><a href="https://github.com/nanxstats" target="_blank" rel="noopener">
                                <svg class="svg-icon mr-1">
                                    <use xlink:href="#github"></use>
                                </svg> @nanxstats</a></li>
                        

                        

                        

                        
                        <li><a href="https://www.linkedin.com/in/nanxstats" target="_blank"
                                rel="noopener">
                                <svg class="svg-icon mr-1">
                                    <use xlink:href="#linkedin"></use>
                                </svg> @nanxstats</a></li>
                        

                        
                        <li><a href="https://twitter.com/nanxstats" target="_blank" rel="noopener">
                                <svg class="svg-icon mr-1">
                                    <use xlink:href="#twitter"></use>
                                </svg> @nanxstats</a></li>
                        

                        

                        
                        <li><a href="https://nanx.me/colophon/">
                                <svg class="svg-icon mr-1">
                                    <use xlink:href="#octicons-terminal"></use>
                                </svg>
                                Colophon</a></li>
                        

                        

                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>


    

    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/r.min.js" defer></script>
        
        <script>
            window.addEventListener('load', function() {
                hljs.highlightAll();
            }, true);
        </script>
    

    

    
    
        
<script src="https://nanx.me/js/math-code.js"></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
</body>

</html>
