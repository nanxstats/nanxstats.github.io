<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> A Simple Link Checker for Hugo and Blogdown Websites - Nan Xiao | 肖楠 </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="How to create a broken link checker for Hugo and blogdown websites." />

    
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="Nan Xiao | 肖楠" />
    <meta property="og:url" content="https://nanx.me/blog/post/link-checker/" />
    <meta property="og:title" content="A Simple Link Checker for Hugo and Blogdown Websites" />
    <meta property="og:description" content="How to create a broken link checker for Hugo and blogdown websites." />
    <meta property="og:image" content="https://nanx.me/image/katie-treadway-EwE4tBYh3ms-unsplash.jpg" />
    <meta property="og:image:secure_url" content="https://nanx.me/image/katie-treadway-EwE4tBYh3ms-unsplash.jpg" />
    <meta property="article:published_time" content=" 2022-02-22T20:00:00Z" />
    <meta property="article:modified_time" content=" 2022-02-22T20:00:00Z" />
    <meta property="article:author" content="Nan Xiao" />

    
    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@nanxstats">
    <meta name="twitter:creator" content="@nanxstats">
    
    <meta name="twitter:title" content="A Simple Link Checker for Hugo and Blogdown Websites" />
    <meta name="twitter:description" content="How to create a broken link checker for Hugo and blogdown websites." />
    <meta name="twitter:image" content="https://nanx.me/image/katie-treadway-EwE4tBYh3ms-unsplash.jpg" />
    <meta name="twitter:image:alt" content="A Simple Link Checker for Hugo and Blogdown Websites" />

    
    <meta property="og:linkedin:actor" content="nanxstats" />

    <link rel="canonical" href="https://nanx.me/blog/post/link-checker/">

    
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        serif: ['"Martina Plantijn"', 'Newsreader', 'Georgia', 'Cambria', '"Times New Roman"', 'Times', 'serif'],
                        sans: ['"Instrument Sans"', 'system-ui', '-apple-system', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', 'sans-serif'],
                        mono: ['"Liga Noto Sans Mono"', 'ui-monospace', 'SFMono-Regular', '"SF Mono"', 'Menlo', 'Consolas', 'monospace'],
                    },
                    colors: {
                        paper: '#fdfdfd',
                        ink: '#1c1c1c',
                        accent: '#991b1b',  
                    },
                    typography: {
                        DEFAULT: {
                            css: {
                                maxWidth: 'none',
                                color: '#1c1c1c',
                                '--tw-prose-body': '#1c1c1c',
                                '--tw-prose-headings': '#1c1c1c',
                                '--tw-prose-links': '#991b1b',
                                '--tw-prose-bold': '#111827',
                                '--tw-prose-counters': '#71717a',
                                '--tw-prose-bullets': '#d4d4d8',
                                '--tw-prose-hr': '#e4e4e7',
                                '--tw-prose-quotes': '#1c1c1c',
                                '--tw-prose-quote-borders': '#d4d4d8',
                                '--tw-prose-captions': '#71717a',
                                '--tw-prose-code': '#1c1c1c',
                                '--tw-prose-pre-code': '#1c1c1c',
                                '--tw-prose-pre-bg': '#fdfdfd',
                                '--tw-prose-th-borders': '#d4d4d8',
                                '--tw-prose-td-borders': '#e4e4e7',
                                'pre': {
                                    color: '#1c1c1c',
                                    backgroundColor: '#fdfdfd !important',
                                    border: '1px solid #e4e4e7',
                                },
                                a: {
                                    color: '#991b1b',
                                    textDecoration: 'none',
                                    fontWeight: '400',
                                    borderBottom: '1px solid transparent',
                                    transition: 'border-color 0.2s ease, color 0.2s ease',
                                },
                                'a:hover': {
                                    color: '#991b1b !important',
                                    borderBottomColor: '#991b1b !important',
                                },
                                h1: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em' },
                                h2: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em', marginTop: '2em' },
                                h3: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                h4: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                blockquote: {
                                    fontStyle: 'italic',
                                    fontWeight: '400',
                                    borderLeftWidth: '2px',
                                },
                                'code::before': { content: 'none' },
                                'code::after': { content: 'none' },
                                ':not(pre) > code': {
                                    fontWeight: '400',
                                    color: '#1c1c1c !important',
                                    backgroundColor: '#f4f4f5 !important',
                                    padding: '0.2em 0.4em',
                                    borderRadius: '0.25rem',
                                    fontSize: '0.875em',
                                },
                            },
                        },
                    },
                },
            },
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
            .tufte-grid {
                display: grid;
                grid-template-columns: 1fr min(65ch, 100%) 1fr;
                column-gap: 2rem;
            }
            .tufte-grid > * {
                grid-column: 2;
            }
            .tufte-grid > .full-width {
                grid-column: 1 / -1;
            }
            .tufte-grid > .margin-note {
                grid-column: 3;
                font-family: "Instrument Sans", sans-serif;
                font-size: 0.875rem;
                line-height: 1.4;
                color: #52525b;  
                margin-top: 0.25rem;
            }
            @media (max-width: 1024px) {
                .tufte-grid {
                    grid-template-columns: 1rem 1fr 1rem;
                }
                .tufte-grid > .margin-note {
                    grid-column: 2;
                    margin-top: 0.5rem;
                    margin-bottom: 1rem;
                    padding-left: 1rem;
                    border-left: 2px solid #e4e4e7;
                }
            }
        }
    </style>

    <link rel="stylesheet" href="https://nanx.me/css/custom.css" />

    
    <link rel="stylesheet" href="https://nanx.me/css/textmate.css" />
    

    

    <link rel="shortcut icon"
        href="https://nanx.me/image/favicon.png">

    
</head>

<body class="bg-paper text-ink font-serif antialiased selection:bg-zinc-200">
    
<header class="py-8 lg:py-12 text-sm font-sans tracking-wide max-w-[67ch] mx-auto w-full px-4 sm:px-6">
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 sm:gap-0">
        <a href="https://nanx.me/" class="font-medium text-ink hover:text-accent transition-colors">
            Nan Xiao
        </a>
        <nav class="flex flex-wrap gap-4 sm:gap-6 text-zinc-600">
            
            
            <a class="text-ink font-medium"
                href="https://nanx.me/blog/">
                Blog
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/software/">
                Software
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/papers/">
                Papers
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/talks/">
                Talks
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/books/">
                Books
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/about/">
                About
            </a>
            
        </nav>
    </div>
</header>

<main class="content my-10 lg:my-20 max-w-[65ch] mx-auto w-full px-4 sm:px-6">
    <article>
        <header class="mb-14">
            <h1 class="text-3xl lg:text-4xl font-sans tracking-tight text-ink font-medium mb-4">A Simple Link Checker for Hugo and Blogdown Websites</h1>

            <div class="text-zinc-500 font-sans text-sm tracking-wide">
                
                
                <span class="author" title="Nan Xiao">
                    Nan Xiao
                </span>
                
                

                <span class="date middot" title='Tue Feb 22 2022 20:00:00 UTC'>
                    February 22, 2022
                </span>

                <span class="reading-time middot">
                    4 min read
                </span>

                <div class="mt-8 flex flex-wrap gap-2">
                    
                    <a href="https://nanx.me/%20tags/r"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        R
                    </a>
                    
                    <a href="https://nanx.me/%20tags/link-checker"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        link checker
                    </a>
                    
                    <a href="https://nanx.me/%20tags/automation"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        automation
                    </a>
                    
                    <a href="https://nanx.me/%20tags/hugo"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        Hugo
                    </a>
                    
                    <a href="https://nanx.me/%20tags/blogdown"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        blogdown
                    </a>
                    
                    <a href="https://nanx.me/%20tags/urlchecker"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        urlchecker
                    </a>
                    
                    
                    
                </div>
            </div>

        </header>

        <div class="prose prose-zinc max-w-none">
            
    
<script src="https://nanx.me/blog/post/link-checker/index_files/header-attrs/header-attrs.js"></script>


<div class="figure">
<img src="https://nanx.me/image/katie-treadway-EwE4tBYh3ms-unsplash.jpg" alt="" />
<p class="caption">Photo by <a href="https://unsplash.com/photos/EwE4tBYh3ms">Katie Treadway</a>.</p>
</div>
<div id="some-background" class="section level2">
<h2>Some background</h2>
<p>I have been blogging with Hugo/blogdown for a while.
One housekeeping task I have always wanted to <a href="https://nanx.me/blog/post/general-purpose-programming-with-r/">automate with R</a>
is scanning the entire website to ensure that all the links are still working.
It is essential for maintaining an enjoyable reading experience without
<a href="https://nanx.me/blog/post/save-the-link-like-a-boss/">archiving</a> too many
external links.</p>
<p>Conceptually, the requirement for a generic broken link checker is quite simple:</p>
<ul>
<li>Get the links to all pages on the site.</li>
<li>Scrape and parse the pages to get the links contained.</li>
<li>Check the link status.</li>
</ul>
<p>However, getting the links to all pages may involve recursive scraping and
parsing of a site. It could make the program behavior unpredictable and
add too many lines for exception handling.</p>
<p>It is dramatically easier if we consider a more specific checker for
Hugo and blogdown websites with certain configurations. For example,
the <a href="https://gohugo.io/templates/sitemap-template/">built-in sitemap in Hugo</a>
allows us to discover the links to all internal pages with one simple
step of XML parsing.</p>
<p>We also have a decent infrastructure in R for page parsing and link checking:</p>
<ul>
<li><a href="https://xml2.r-lib.org/">xml2</a> and <a href="https://rvest.tidyverse.org/">rvest</a>
to parse and extract elements from the XML and HTML;</li>
<li><a href="https://cran.r-project.org/package=urlchecker">urlchecker</a> to check
links in parallel, with informative feedback.
It was initially built for checking the links in R packages before
submitting to CRAN but can be easily repurposed.</li>
</ul>
<p>Let’s try building a minimum viable link checker with these in mind.</p>
</div>
<div id="get-the-links" class="section level2">
<h2>Get the links</h2>
<p>We first use the sitemap to get the links to all internal pages,
then parse every internal page to extract the links contained.
With the help of xml2 and rvest, we only need a few lines of code:</p>
<pre class="r"><code>#&#39; Get all links on Hugo/blogdown site
#&#39;
#&#39; @param sitemap Sitemap URL of a Hugo/blogdown site
#&#39; @return Character vector of links from all pages
get_blogdown_links &lt;- function(sitemap) {
  lst &lt;- sitemap |&gt;
    xml2::read_xml() |&gt;
    xml2::as_list()
  urlset &lt;- lst[[&quot;urlset&quot;]] |&gt;
    sapply(&quot;[[&quot;, &quot;loc&quot;) |&gt;
    unlist(use.names = FALSE) |&gt;
    unique()

  content &lt;- lapply(urlset, xml2::read_html)
  extract_links &lt;- function(x, tag, attr) {
    x |&gt;
      rvest::html_elements(tag) |&gt;
      rvest::html_attr(attr)
  }

  lapply(content, extract_links, tag = &quot;a&quot;, attr = &quot;href&quot;) |&gt;
    unlist() |&gt;
    unique()
}</code></pre>
<p>The returned vector will contain both internal and external links.</p>
</div>
<div id="check-link-status" class="section level2">
<h2>Check link status</h2>
<p>We can write the links into a file under a minimally sufficient R package
format so that <code>urlchecker::url_check()</code> thinks this is an R package
and can proceed to check them.</p>
<pre class="r"><code>#&#39; Create a mockup package containing all links to check
#&#39;
#&#39; @param links Character vector of links to check
#&#39; @return Path to the package
use_mockup_pkg &lt;- function(links) {
  pkgname &lt;- paste(sample(letters, size = 10, replace = TRUE), collapse = &quot;&quot;)
  pkgpath &lt;- file.path(tempdir(), pkgname)
  dir.create(pkgpath)
  writeLines(paste0(&quot;&lt;&quot;, links, &quot;&gt;&quot;), con = file.path(pkgpath, &quot;README.md&quot;))
  writeLines(c(&quot;Package: placeholder&quot;), con = file.path(pkgpath, &quot;DESCRIPTION&quot;))
  pkgpath
}</code></pre>
<p>Connect the pipes:</p>
<pre class="r"><code>&quot;https://nanx.me/sitemap.xml&quot; |&gt;
  get_blogdown_links() |&gt;
  use_mockup_pkg() |&gt;
  urlchecker::url_check()</code></pre>
<p>The outputs are self-explanatory. Most of the data points for my site
are graceful <a href="https://yihui.org/en/2017/11/301-redirect/">301 redirects</a>,
including common patterns such as HTTP to HTTPS migration,
change of host domain names, and change of URL path scheme.
Sometimes, there is a straightforward 404 that should be fixed.</p>
<pre class="text"><code>! Warning: README.md:286:2 Moved
&lt;http://jmlr.csail.mit.edu/papers/volume10/weinberger09a/weinberger09a.pdf&gt;
 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 https://jmlr.csail.mit.edu/papers/volume10/weinberger09a/weinberger09a.pdf

...

! Warning: README.md:352:2 Moved
&lt;https://blog.github.com/2018-05-01-github-pages-custom-domains-https/&gt;
 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 https://github.blog/2018-05-01-github-pages-custom-domains-https/

...

! Warning: README.md:285:2 Moved
&lt;https://dl.acm.org/citation.cfm?id=2968618.2968683&gt;
 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 https://dl.acm.org/doi/10.5555/2968618.2968683

...

x Error: README.md:404:2 404: Not Found
&lt;https://www.math.ualberta.ca/mss/misc/A%20Mathematician&#39;s%20Apology.pdf&gt;
 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</code></pre>
</div>
<div id="limitations" class="section level2">
<h2>Limitations</h2>
<p>A few limitations of this simple checker:</p>
<ul>
<li>This checker did not handle the case where relative URLs are used for
linking internal pages. It worked for me because
<ul>
<li>I use absolute URLs to link all pages when
creating content, even if it is an internal resource;</li>
<li>I also did not enable <code>relativeURLs</code> in the
<a href="https://gohugo.io/content-management/urls/#relative-urls">Hugo configuration</a>.
Therefore, all rendered links to internal pages are absolute URLs.</li>
</ul></li>
<li>This checker did not check resources linked using a tag other than <code>&lt;a&gt;</code>,
such as images linked with <code>&lt;img src="..."&gt;</code>.
<ul>
<li>It is trivial to extend it to handle resources linked with other
HTML tags and attributes.</li>
<li>For external resources such as images, I have the habit of saving
and serving a local copy while explicitly linking the source with
<code>&lt;a&gt;</code> whenever possible.</li>
</ul></li>
</ul>
</div>



        </div>

        
        <nav class="pagination-nav mt-10 mb-3" aria-label="Blog post navigation">
            <div class="navigation-btns">
                
                <a href="https://nanx.me/blog/post/font-variant-numeric/" class="btn-nav btn-prev w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Previous</div>
                        <div class="pagination-nav-label">&laquo; Font Variant Numeric</div>
                    </div>
                </a>
                

                
                <a href="https://nanx.me/blog/post/shiny-fcp-loader/" class="btn-nav btn-next w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Next</div>
                        <div class="pagination-nav-label">Architecting Large Shiny Apps with Minimal First Contentful Paint Time &raquo;</div>
                    </div>
                </a>
                
            </div>
        </nav>
        

    </article>
</main>

<section id="comments">
    <div class="py-3 content">
        <div class="mx-auto max-w-[65ch] w-full px-4 sm:px-6">
            <div class="comments">
                <script src="https://utteranc.es/client.js" repo="nanxstats/blog-comments" issue-term="pathname"
                    label="comment" theme="github-light" crossorigin="anonymous" async>
                    </script>
            </div>
        </div>
    </div>
</section>
<footer class="mt-20 mb-10 text-center font-sans text-sm text-zinc-500 tracking-wide">
    <div class="tufte-grid">
        <div class="flex flex-col items-center gap-4">
            <div class="flex flex-wrap items-center justify-center gap-x-4 gap-y-2">
                
                
                <a href="https://github.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">GitHub</a>
                
                
                
                
                <a href="https://www.linkedin.com/in/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">LinkedIn</a>
                
                
                <a href="https://bsky.app/profile/nanxstats.bsky.social" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Bluesky</a>
                
                
                <a href="https://twitter.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Twitter</a>
                
                
                
                <a href="https://nanx.me/colophon/" class="hover:text-accent transition-colors">Colophon</a>
                
                
            </div>

            
            <div class="mt-2">
                © 2026 Nan Xiao. All rights reserved.
            </div>
            
        </div>
    </div>
</footer>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"
        integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/r.min.js" defer></script>
    
    <script>
        window.addEventListener('load', function () {
            hljs.highlightAll();
        }, true);
    </script>
    

    

    
    
    

    
</body>

</html>