<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> FLUX.1 &#43; LoRA for styled image generation - Nan Xiao | ËÇñÊ•† </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="A simple guide to set up and use FLUX.1 with LoRA adapters for AI image generation on a local Windows PC. This post covers downloading necessary models and software, model file placement, and configuring ComfyUI to run the foundation model and add LoRA nodes to the workflow.
" />

    
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="Nan Xiao | ËÇñÊ•†" />
    <meta property="og:url" content="https://nanx.me/blog/post/flux-lora/" />
    <meta property="og:title" content="FLUX.1 &#43; LoRA for styled image generation" />
    <meta property="og:description" content="A simple guide to set up and use FLUX.1 with LoRA adapters for AI image generation on a local Windows PC. This post covers downloading necessary models and software, model file placement, and configuring ComfyUI to run the foundation model and add LoRA nodes to the workflow.
" />
    <meta property="og:image" content="https://nanx.me/image/flux-lora-tech-line-drawing.png" />
    <meta property="og:image:secure_url" content="https://nanx.me/image/flux-lora-tech-line-drawing.png" />
    <meta property="article:published_time" content="2024-09-30T23:47:00Z" />
    <meta property="article:modified_time" content="2024-09-30T23:47:00Z" />
    <meta property="article:author" content="Nan Xiao" />

    
    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@nanxstats">
    <meta name="twitter:creator" content="@nanxstats">
    
    <meta name="twitter:title" content="FLUX.1 &#43; LoRA for styled image generation" />
    <meta name="twitter:description" content="A simple guide to set up and use FLUX.1 with LoRA adapters for AI image generation on a local Windows PC. This post covers downloading necessary models and software, model file placement, and configuring ComfyUI to run the foundation model and add LoRA nodes to the workflow.
" />
    <meta name="twitter:image" content="https://nanx.me/image/flux-lora-tech-line-drawing.png" />
    <meta name="twitter:image:alt" content="FLUX.1 &#43; LoRA for styled image generation" />

    
    <meta property="og:linkedin:actor" content="nanxstats" />

    <link rel="canonical" href="https://nanx.me/blog/post/flux-lora/">

    
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        serif: ['"Martina Plantijn"', 'Newsreader', 'Georgia', 'Cambria', '"Times New Roman"', 'Times', 'serif'],
                        sans: ['"Instrument Sans"', 'system-ui', '-apple-system', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', 'sans-serif'],
                        mono: ['"Liga Noto Sans Mono"', 'ui-monospace', 'SFMono-Regular', '"SF Mono"', 'Menlo', 'Consolas', 'monospace'],
                    },
                    colors: {
                        paper: '#fdfdfd',
                        ink: '#1c1c1c',
                        accent: '#991b1b',  
                    },
                    typography: {
                        DEFAULT: {
                            css: {
                                maxWidth: 'none',
                                color: '#1c1c1c',
                                '--tw-prose-body': '#1c1c1c',
                                '--tw-prose-headings': '#1c1c1c',
                                '--tw-prose-links': '#991b1b',
                                '--tw-prose-bold': '#111827',
                                '--tw-prose-counters': '#71717a',
                                '--tw-prose-bullets': '#d4d4d8',
                                '--tw-prose-hr': '#e4e4e7',
                                '--tw-prose-quotes': '#1c1c1c',
                                '--tw-prose-quote-borders': '#d4d4d8',
                                '--tw-prose-captions': '#71717a',
                                '--tw-prose-code': '#1c1c1c',
                                '--tw-prose-pre-code': '#1c1c1c',
                                '--tw-prose-pre-bg': '#fdfdfd',
                                '--tw-prose-th-borders': '#d4d4d8',
                                '--tw-prose-td-borders': '#e4e4e7',
                                'pre': {
                                    color: '#1c1c1c',
                                    backgroundColor: '#fdfdfd !important',
                                    border: '1px solid #e4e4e7',
                                },
                                a: {
                                    color: '#991b1b',
                                    textDecoration: 'none',
                                    fontWeight: '400',
                                    borderBottom: '1px solid transparent',
                                    transition: 'border-color 0.2s ease, color 0.2s ease',
                                },
                                'a:hover': {
                                    color: '#991b1b !important',
                                    borderBottomColor: '#991b1b !important',
                                },
                                h1: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em' },
                                h2: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500', letterSpacing: '-0.025em', marginTop: '2em' },
                                h3: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                h4: { fontFamily: '"Instrument Sans", sans-serif', fontWeight: '500' },
                                blockquote: {
                                    fontStyle: 'italic',
                                    fontWeight: '400',
                                    borderLeftWidth: '2px',
                                },
                                'code::before': { content: 'none' },
                                'code::after': { content: 'none' },
                                ':not(pre) > code': {
                                    fontWeight: '400',
                                    color: '#1c1c1c !important',
                                    backgroundColor: '#f4f4f5 !important',
                                    padding: '0.2em 0.4em',
                                    borderRadius: '0.25rem',
                                    fontSize: '0.875em',
                                },
                            },
                        },
                    },
                },
            },
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
            .tufte-grid {
                display: grid;
                grid-template-columns: 1fr min(65ch, 100%) 1fr;
                column-gap: 2rem;
            }
            .tufte-grid > * {
                grid-column: 2;
            }
            .tufte-grid > .full-width {
                grid-column: 1 / -1;
            }
            .tufte-grid > .margin-note {
                grid-column: 3;
                font-family: "Instrument Sans", sans-serif;
                font-size: 0.875rem;
                line-height: 1.4;
                color: #52525b;  
                margin-top: 0.25rem;
            }
            @media (max-width: 1024px) {
                .tufte-grid {
                    grid-template-columns: 1rem 1fr 1rem;
                }
                .tufte-grid > .margin-note {
                    grid-column: 2;
                    margin-top: 0.5rem;
                    margin-bottom: 1rem;
                    padding-left: 1rem;
                    border-left: 2px solid #e4e4e7;
                }
            }
        }
    </style>

    <link rel="stylesheet" href="https://nanx.me/css/custom.css" />

    
    <link rel="stylesheet" href="https://nanx.me/css/textmate.css" />
    

    

    <link rel="shortcut icon"
        href="https://nanx.me/image/favicon.png">

    
</head>

<body class="bg-paper text-ink font-serif antialiased selection:bg-zinc-200">
    
<header class="py-8 lg:py-12 text-sm font-sans tracking-wide max-w-[67ch] mx-auto w-full px-4 sm:px-6">
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 sm:gap-0">
        <a href="https://nanx.me/" class="font-medium text-ink hover:text-accent transition-colors">
            Nan Xiao
        </a>
        <nav class="flex flex-wrap gap-4 sm:gap-6 text-zinc-600">
            
            
            <a class="text-ink font-medium"
                href="https://nanx.me/blog/">
                Blog
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/software/">
                Software
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/papers/">
                Papers
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/talks/">
                Talks
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/books/">
                Books
            </a>
            
            <a class="hover:text-accent transition-colors"
                href="https://nanx.me/about/">
                About
            </a>
            
        </nav>
    </div>
</header>

<main class="content my-10 max-w-[65ch] mx-auto w-full px-4 sm:px-6">
    <article>
        <header class="mb-14">
            <h1 class="text-3xl lg:text-4xl font-sans tracking-tight text-ink font-medium mb-4">FLUX.1 &#43; LoRA for styled image generation</h1>

            <div class="text-zinc-500 font-sans text-sm tracking-wide">
                
                
                <span class="author" title="Nan Xiao">
                    Nan Xiao
                </span>
                
                

                <span class="date middot tabular-nums" title='Mon Sep 30 2024 23:47:00 UTC'>
                    September 30, 2024
                </span>

                <span class="reading-time middot">
                    4 min read
                </span>

                <div class="mt-8 flex flex-wrap gap-2">
                    
                    <a href="https://nanx.me/tags/text-to-image"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        text to image
                    </a>
                    
                    <a href="https://nanx.me/tags/image-generation"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        image generation
                    </a>
                    
                    <a href="https://nanx.me/tags/flux"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        FLUX
                    </a>
                    
                    <a href="https://nanx.me/tags/diffusers"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        Diffusers
                    </a>
                    
                    <a href="https://nanx.me/tags/lora"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        LoRA
                    </a>
                    
                    <a href="https://nanx.me/tags/adapters"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        adapters
                    </a>
                    
                    <a href="https://nanx.me/tags/hugging-face"
                        class="inline-flex items-center px-3 py-1 rounded-full bg-zinc-100 text-zinc-600 hover:bg-zinc-200 hover:text-ink transition-colors text-xs font-medium tracking-wide">
                        Hugging Face
                    </a>
                    
                    
                    
                </div>
            </div>

        </header>

        <div class="prose prose-zinc max-w-none">
            
    


<style type="text/css">
.content .blog-post-title { letter-spacing: -1.1px; }
</style>
<div class="float">
<img src="https://nanx.me/image/flux-lora-tech-line-drawing.png" alt="Technical line drawing generated by Flux1.dev + LoRA adapter.  Prompt: techlinedrawing, a drawing of a glass-heavy, modern architecture that Californian venture capital firms like, with fine details and mountains in the back, white background." />
<div class="figcaption">Technical line drawing generated by Flux1.dev + LoRA adapter.<br>
Prompt: techlinedrawing, a drawing of a glass-heavy, modern architecture that
Californian venture capital firms like, with fine details and mountains
in the back, white background.</div>
</div>
<p>Besides playing the Elden Ring: Shadow of the Erdtree DLC and Black Myth: Wukong
on my gaming rig, I‚Äôve also been playing with open weights generative AI models
lately. As always, I‚Äôm more than <a href="https://nanx.me/blog/post/pkglite-llm-prompt/">impressed</a>
by the speed of innovation in this space.</p>
<p>For text generation models, at the moment (September 2024), I still feel the
output quality has a bit of a bottleneck on the type of foundation models
we can use and run with limited VRAM at an acceptable speed.
This may change any day in the future, though, so I‚Äôm turning my
attention to the latest image generation models.
Of course, I need to try Flux.1 from Black Forest Labs.</p>
<p>Theoretically, you only need to write a simple Python script to call
the Diffusers package to run the model. I still chose to use a web
GUI here because it‚Äôs nice to have an automated, no-code solution
with a frontend for workflow construction and submitting prompts.</p>
<p>The results feel decent for the <strong>minimal</strong> number of things I tried.
You likely need to experiment with different random number seeds and different
prompts to get there, so it‚Äôs important to have a good GPU or good patience.</p>
<div id="technical-setup-guide" class="section level2">
<h2>Technical setup guide</h2>
<p>At the time of writing, the setup process to get things running is
not exactly apparent, so I will document it here.
This has been tested on a Windows PC with an RTX 4090 (24GB VRAM).</p>
<div id="download-web-gui-software" class="section level3">
<h3>Download web GUI software</h3>
<p>There are many options, but I will use a simple one (ComfyUI) as an example.
It has a built-in Python with essential dependencies like PyTorch and Diffusers.
It might not be <strong>security best practice</strong> to blindly trust code and binaries
on the internet, but hey‚Ä¶ make sure to do your own audit.
The workflow editor frontend is built with their fork of litegraph.js.</p>
</div>
<div id="download-models" class="section level3">
<h3>Download models</h3>
<ol style="list-style-type: decimal">
<li>Download <code>flux1-dev.safetensors</code> and <code>ae.safetensors</code> from
<a href="https://huggingface.co/black-forest-labs/FLUX.1-dev">black-forest-labs/FLUX.1-dev</a>
on Hugging Face. There is also a commercial-friendly model
<a href="https://huggingface.co/black-forest-labs/FLUX.1-schnell">FLUX.1-schnell</a>.</li>
<li>Download <code>t5xxl_fp8_e4m3fn.safetensors</code> and <code>clip_l.safetensors</code> from
<a href="https://huggingface.co/comfyanonymous/flux_text_encoders/tree/main">comfyanonymous/flux_text_encoders</a>.</li>
<li>(Optional) Download your preferred LoRA model (<code>.safetensors</code>) from
<a href="https://huggingface.co/models?other=base_model:adapter:black-forest-labs/FLUX.1-dev">FLUX.1-dev adapters</a> for particular styles (there are 4,000+ of them).
I used <a href="https://huggingface.co/jeremytai/techlinedrawing">jeremytai/techlinedrawing</a>
for the example image at the start of the post.</li>
</ol>
</div>
<div id="place-models-in-the-correct-directory" class="section level3">
<h3>Place models in the correct directory</h3>
<ol style="list-style-type: decimal">
<li><code>ComfyUI/models/unet/</code>: place <code>flux1-dev.safetensors</code></li>
<li><code>ComfyUI/models/vae/</code>: place <code>ae.safetensors</code></li>
<li><code>ComfyUI/models/clip/</code>: place <code>t5xxl_fp8_e4m3fn.safetensors</code> and <code>clip_l.safetensors</code></li>
<li><code>ComfyUI/models/loras/</code>: place your LoRA model‚Äôs <code>.safetensors</code> file</li>
</ol>
</div>
<div id="run-the-foundation-model" class="section level3">
<h3>Run the foundation model</h3>
<ol style="list-style-type: decimal">
<li>Run <code>run_nvidia_gpu.bat</code></li>
<li>Drag the image on the <a href="https://comfyanonymous.github.io/ComfyUI_examples/flux/">ComfyUI Flux examples</a> page into the ComfyUI page to import the Flux workflow.</li>
<li>Select the correct files in the interface:
<ul>
<li>Load Diffusion Model - unet_name: <code>flux1-dev.safetensors</code></li>
<li>DualCLIPLoader - clip_name1: <code>t5xxl_fp8_e4m3fn.safetensors</code>, clip_name2: <code>clip_l.safetensors</code></li>
<li>Load VAE - vae_name: <code>ae.safetensors</code></li>
</ul></li>
</ol>
<p>Now, the workflow is ready to run. Click ‚ÄúQueue Prompt‚Äù to generate the example
image with the default prompt and seed. It took about 10 seconds on my machine.</p>
</div>
<div id="add-lora-node-to-the-workflow" class="section level3">
<h3>Add LoRA node to the workflow</h3>
<ol style="list-style-type: decimal">
<li>Right-click on canvas, and select Add Node &gt; loaders &gt; Load LoRA.</li>
<li>In the new node, select lora_name as the LoRA model file name (<code>.safetensors</code>).</li>
<li>Insert the ‚ÄúLoad LoRA‚Äù node between the ‚ÄúLoad Diffusion Model‚Äù node and
the ‚ÄúBasicGuider‚Äù node, to do this:
<ul>
<li>Connect the Load diffusion model node‚Äôs <code>MODEL</code> output to the
Load LoRA node‚Äôs <code>model</code> input.</li>
<li>Connect the DualCLIPLoader node‚Äôs <code>CLIP</code> output to the
Load LoRA node‚Äôs <code>clip</code> input.</li>
<li>Connect the Load LoRA node‚Äôs <code>MODEL</code> output to the
BasicGuider node‚Äôs <code>model</code> input.</li>
<li>Connect the Load LoRA node‚Äôs <code>CLIP</code> output to the
CLIP Text Encode (Positive Prompt) node‚Äôs <code>clip</code> input.</li>
</ul></li>
</ol>
<p>Write the prompt with the LoRA adapter‚Äôs ‚Äútrigger words‚Äù. The words are often
listed in the <code>README.md</code> files of the LoRA repos.</p>
<p>Click ‚ÄúQueue Prompt‚Äù to generate images. If you click it many times, they
will be queued and generated sequentially. Besides displaying on the interface
once, all generated images will be stored in <code>ComfyUI/output</code>.</p>
<div class="float">
<img src="images/flux-lora-comfyui.png" alt="Running a Flux1.dev + LoRA workflow in ComfyUI." />
<div class="figcaption">Running a Flux1.dev + LoRA workflow in ComfyUI.</div>
</div>
<p>To exit, press Ctrl + C in the terminal and then press Y.</p>
<p>Now I‚Äôve done it ‚Äî writing my first ‚Äúopen source AI‚Äù blog post! ü§ó</p>
</div>
</div>



        </div>

        
        <nav class="pagination-nav mt-10 mb-3" aria-label="Blog post navigation">
            <div class="navigation-btns">
                
                <a href="https://nanx.me/blog/post/group-sequential-trials-industry-30-years/" class="btn-nav btn-prev w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Previous</div>
                        <div class="pagination-nav-label">&laquo; Group sequential trials in industry: a 30-year perspective</div>
                    </div>
                </a>
                

                
                <a href="https://nanx.me/blog/post/tinytopics/" class="btn-nav btn-next w-full">
                    <div class="btn-content">
                        <div class="pagination-nav-sublabel">Next</div>
                        <div class="pagination-nav-label">tinytopics: GPU-accelerated topic modeling via constrained neural Poisson NMF &raquo;</div>
                    </div>
                </a>
                
            </div>
        </nav>
        

    </article>
</main>

<section id="comments">
    <div class="py-3 content">
        <div class="mx-auto max-w-[65ch] w-full px-4 sm:px-6">
            <div class="comments">
                <script src="https://utteranc.es/client.js" repo="nanxstats/blog-comments" issue-term="pathname"
                    label="comment" theme="github-light" crossorigin="anonymous" async>
                    </script>
            </div>
        </div>
    </div>
</section>
<footer class="mt-20 mb-10 text-center font-sans text-sm text-zinc-500 tracking-wide">
    <div class="tufte-grid">
        <div class="flex flex-col items-center gap-4">
            <div class="flex flex-wrap items-center justify-center gap-x-4 gap-y-2">
                
                
                <a href="https://github.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">GitHub</a>
                
                
                
                
                <a href="https://www.linkedin.com/in/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">LinkedIn</a>
                
                
                <a href="https://bsky.app/profile/nanxstats.bsky.social" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Bluesky</a>
                
                
                <a href="https://twitter.com/nanxstats" target="_blank" rel="noopener"
                    class="hover:text-accent transition-colors">Twitter</a>
                
                
                
                <a href="https://nanx.me/colophon/" class="hover:text-accent transition-colors">Colophon</a>
                
                
            </div>

            
            <div class="mt-2">
                ¬© 2026 Nan Xiao. All rights reserved.
            </div>
            
        </div>
    </div>
</footer>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"
        integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/r.min.js" defer></script>
    
    <script>
        window.addEventListener('load', function () {
            hljs.highlightAll();
        }, true);
    </script>
    

    

    
    
    

    
</body>

</html>