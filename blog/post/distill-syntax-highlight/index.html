<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> Customize Syntax Highlighting for R distill Websites - Nan Xiao | 肖楠 </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="Customize the distill syntax highlighting theme with a few lines of R code." />
    <meta property="og:site_name" content="Nan Xiao | 肖楠" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://nanx.me/blog/post/distill-syntax-highlight/" />
    <meta property="og:title" content="Customize Syntax Highlighting for R distill Websites" />
    <meta property="og:image" content="https://nanx.me/image/wine-bottles-chuttersnap.jpg" />
    <meta property="og:description" content="Customize the distill syntax highlighting theme with a few lines of R code." />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@nanxstats">
    <meta name="twitter:creator" content="@nanxstats">
    
    <meta name="twitter:title" content="Customize Syntax Highlighting for R distill Websites" />
    <meta name="twitter:description" content="Customize the distill syntax highlighting theme with a few lines of R code." />
    <meta name="twitter:image" content="https://nanx.me/image/wine-bottles-chuttersnap.jpg" />

    <link rel="canonical" href="https://nanx.me/blog/post/distill-syntax-highlight/">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css" integrity="sha512-GQGU0fMMi238uA+a/bdWJfpUGKUkBdgfFdgBm72SUQ6BeyWjoY/ton0tEjH+OSH9iP4Dfh+7HM0I9f5eR0L/4w==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="https://nanx.me/css/custom.css" />

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/github.min.css" integrity="sha512-0aPQyyeZrWj9sCA46UlmWgKOP0mUipLQ6OZXu8l4IcAmD2u31EPEy9VcIMvl7SoAaKe8bLXZhYoMaE/in+gcgA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    

    

    <link rel="shortcut icon"
        href="https://nanx.me/image/favicon.png">

    
    <link href="https://nanx.me/index.xml" rel="alternate" type="application/rss+xml" title="Nan Xiao | 肖楠" />
    
</head>

<body>
    
<div class="my-4 my-lg-5 header">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-sm-12 col-lg-6">
                <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                        
                        <a href="https://nanx.me/">
                            <img class="logo img-fluid d-block rounded-circle"
                                src="https://nanx.me/image/nanxiao.jpg" alt="Portrait of Nan Xiao">
                        </a>
                        
                    </div>
                    <div class="flex-grow-1 ms-3">
                        <a href="https://nanx.me/">
                            <h1 class="name">Nan Xiao</h1>
                        </a>

                        <ul class="nav nav-primary">
                            
                            <li class="nav-item">
                                <a class="nav-link text-blog"
                                    href="https://nanx.me/blog/">
                                    
                                    Blog
                                </a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link text-software"
                                    href="https://nanx.me/software/">
                                    
                                    Software
                                </a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link text-papers"
                                    href="https://nanx.me/papers/">
                                    
                                    Papers
                                </a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link text-talks"
                                    href="https://nanx.me/talks/">
                                    
                                    Talks
                                </a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link text-books"
                                    href="https://nanx.me/books/">
                                    
                                    Books
                                </a>
                            </li>
                            
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="content">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-sm-12 col-lg-6">
                <h1 class="blog-post-title">Customize Syntax Highlighting for R distill Websites</h1>

                <div class="mb-md-4 meta">
                    
                    
                    <span class="author" title="Nan Xiao">
                        Nan Xiao
                    </span>
                    
                    

                    <span class="date middot" title='Fri May 22 2020 00:30:00 UTC'>
                        2020-05-22
                    </span>

                    <span class="reading-time middot">
                        2 min read
                    </span>

                    <div class="d-none d-md-inline tags">
                        <ul class="list-unstyled d-inline">
                            
                            <li class="d-inline middot">
                                <a href="https://nanx.me/tags/r">R</a>
                            </li>
                            
                            <li class="d-inline middot">
                                <a href="https://nanx.me/tags/r-markdown">R Markdown</a>
                            </li>
                            
                            <li class="d-inline middot">
                                <a href="https://nanx.me/tags/distill">distill</a>
                            </li>
                            
                        </ul>
                    </div>

                    <div class="d-none d-md-inline tags">
                        <ul class="list-unstyled d-inline">
                            
                            
                        </ul>
                    </div>
                </div>

                <div class="markdown blog-post-content">
                    
    
<script src="https://nanx.me/blog/post/distill-syntax-highlight/index_files/header-attrs/header-attrs.js"></script>


<div class="figure">
<img src="https://nanx.me/image/wine-bottles-chuttersnap.jpg" alt="" />
<p class="caption">“Diversity is essential to happiness, and in Utopia there is hardly any.” (Bertrand Russell) <br> Photo by <a href="https://unsplash.com/photos/eKlezhItE5U"><span class="citation">@chuttersnap</span></a>.</p>
</div>
<div id="the-problem" class="section level2">
<h2>The Problem</h2>
<p>The <a href="https://rstudio.github.io/distill/">distill</a> (formerly radix) package offers an excellent option in the R Markdown ecosystem to create beautifully typed websites. I was using it one day and looking into customizing the syntax highlighting theme. Then I found <a href="https://github.com/rstudio/distill/issues/19">this issue</a>:</p>
<div class="figure">
<img src="distill-custom-highlight-theme.png" alt="" />
<p class="caption"> </p>
</div>
<p>I was a bit surprised and sad that there is no easy way to customize it. As a person with some opinions myself, I entirely respect the design choices, while I do hold some alternative views on two aspects of this.</p>
<p>First of all, I agree that the philosophy behind a software product is critical, and sometimes we have to balance the experience and flexibility one offers in the software. However, in reality, it is easy to use “experience” as an excuse for the lack of flexibility. For example, <em>enforcing</em> a unified theme within a website does not mean that one cannot <em>specify</em> that theme (or its details such as syntax highlighting) for their websites.</p>
<p>The second point is purely technical. If you look into the distill source code, it encodes all the syntax highlighting related CSS code (and others) in JavaScript (inst/www/distill/template.v2.js) and renders the styles with JS. This was done in a quite elegant but rather obscure way that makes simple CSS overrides challenging. Plus, CSS-in-JS does not seem to be a good engineering practice to me as it unnecessarily increases the developer’s cognitive load.</p>
</div>
<div id="a-solution" class="section level2">
<h2>A solution</h2>
<p>Since there is no formal extension mechanism for this part of distill and I’m not interested in deciphering the JS code, here comes a pure R solution. The following function finds and replaces the syntax highlighting CSS in the JS file from the installed distill package. You can choose or modify any custom CSS themes created for Prism.js, which are widely available and easily customizable.</p>
<script src="https://gist.github.com/nanxstats/ef265d4322168a049daa9154a38afa86.js"></script>
<p>This is a hot patch, meaning you can rebuild the websites and see the results immediately without restarting the R session or reloading the package. It is also a binary patch, meaning the patched package is prone to updates or reinstalls (the patched JS file is overridden). In case the patch didn’t work, a simple reinstall of distill would restore things to normal. It is far from ideal, and I believe people can build more permanent solutions, such as creating an R package with renderers that allow such “extra customizations.”</p>
</div>



                </div>

                
                <div class="navigation">
                    <div class="row">
                        <div class="col-12 col-lg-6">
                            
                            <div class="mt-4 text-start">
                                <a href="https://nanx.me/blog/post/disposable-computing-with-callr/">« Disposable Computing with callr</a>
                            </div>
                            
                        </div>
                        <div class="col-12 col-lg-6">
                            
                            <div class="mt-4 text-end">
                                <a href="https://nanx.me/blog/post/migrating-from-disqus-to-utterances/">Migrating from Disqus to Utterances »</a>
                            </div>
                            
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
</div>

<section id="comments">
    <div class="py-3 content">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-sm-12 col-lg-6">
                    <div class="comments">
                        <script src="https://utteranc.es/client.js" repo="nanxstats/blog-comments"
                            issue-term="pathname" label="comment" theme="github-light" crossorigin="anonymous" async>
                            </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<div class="footer mt-5">
    <div class="container">

        <div class="row justify-content-center">
            <div class="col-sm-12 col-lg-6">
                <hr>
            </div>
        </div>

        <div class="row justify-content-center">
            <div class="col-sm-12 col-lg-6">
                
                <div class="site-copyright">
                    © 2011–2022 Nan Xiao
                </div>
                
            </div>
        </div>
        <div class="row justify-content-center mt-1 mb-5">
            <div class="col-sm-12 col-lg-6">
                <div class="site-social">
                    <ul>
                        

                        
                        <li><a href="https://github.com/nanxstats" target="_blank"
                                rel="noopener">GitHub</a></li>
                        

                        

                        

                        
                        <li><a href="https://twitter.com/nanxstats" target="_blank"
                                rel="noopener">Twitter</a></li>
                        

                        
                        <li><a href="https://www.linkedin.com/in/nanxstats" target="_blank"
                                rel="noopener">LinkedIn</a></li>
                        

                        
                        <li><a href="https://nanx.me/colophon/">Colophon</a></li>
                        

                        
                        <li><a href="https://nanx.me/index.xml" class="mr-0">RSS</a></li>
                        

                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>


    

    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js" integrity="sha512-Pbb8o120v5/hN/a6LjF4N4Lxou+xYZ0QcVF8J6TWhBbHmctQWd8O6xTDmHpE/91OjPzCk4JRoiJsexHYg4SotQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/r.min.js" defer></script>
        
        <script>
            window.addEventListener('load', function() {
                hljs.highlightAll();
            }, true);
        </script>
    

    

    
    
        

    
</body>

</html>
