<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> Shiny Now Supports Async Execution - Nan Xiao | 肖楠 </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="" />
    <meta property="og:site_name" content="Nan Xiao | 肖楠" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://nanx.me/blog/post/shiny-async/" />
    <meta property="og:title" content="Shiny Now Supports Async Execution" />
    <meta property="og:image" content="https://nanx.me/image/nanxiao.jpg" />
    <meta property="og:description" content="" />

    
        <meta property="twitter:site" content="@road2stat">
    

    <meta property="twitter:title" content="Shiny Now Supports Async Execution" />
    <meta property="twitter:image" content="https://nanx.me/image/nanxiao.jpg" />
    <meta property="twitter:card" content="summary" />
    <meta property="twitter:description" content="" />

    <link rel="canonical" href="https://nanx.me/blog/post/shiny-async/">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha256-YLGeXaapI0/5IgZopewRJcFXomhRMlYYjugPLSyNjTY=" crossorigin="anonymous" />

    <link rel="stylesheet" href="https://nanx.me/css/custom.css" />

    
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/styles/tomorrow.min.css" integrity="sha256-0QU8ry64q+N6YBIEF/6XF6vUeF15gbNO4tLS6ikk0FI=" crossorigin="anonymous" />
    

    

    <link rel="shortcut icon"
        href="https://nanx.me/image/favicon.png">

    
</head>

<body>
    
    <div class="my-4 my-md-5 header">
    <div class="container">
        <div class="row">
            <div class="col-auto offset-md-1 d-none d-md-block">
                
                    <a href="https://nanx.me/">
                        <img class="ml-md-4 logo img-fluid d-block rounded-circle" src="https://nanx.me/image/nanxiao.jpg" alt="logo">
                    </a>
                
            </div>
            <div class="col-auto align-self-center mr-auto">
                <a href="https://nanx.me/">
                    <h1 class="name">Nan Xiao</h1>
                </a>

                <ul class="nav nav-primary">
                    
                        <li class="nav-item">
                            <a class="text-uppercase nav-link text-software" href="https://nanx.me/software/">
                                
                                Software
                            </a>
                        </li>
                    
                        <li class="nav-item">
                            <a class="text-uppercase nav-link text-papers" href="https://nanx.me/papers/">
                                
                                Papers
                            </a>
                        </li>
                    
                        <li class="nav-item">
                            <a class="text-uppercase nav-link text-books" href="https://nanx.me/books/">
                                
                                Books
                            </a>
                        </li>
                    
                        <li class="nav-item">
                            <a class="text-uppercase nav-link text-talks" href="https://nanx.me/talks/">
                                
                                Talks
                            </a>
                        </li>
                    
                        <li class="nav-item">
                            <a class="text-uppercase nav-link text-blog" href="https://nanx.me/blog/">
                                
                                Blog
                            </a>
                        </li>
                    

                    
                </ul>

            </div>
        </div>
    </div>
</div>


    <div class="content">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-sm-12 col-md-10">
                    <h1 class="mx-0 mx-md-4 blog-post-title">Shiny Now Supports Async Execution</h1>

                    <div class="mb-md-4 meta">
                        
                            
                                <span class="author" title="Nan Xiao">
                                    Nan Xiao
                                </span>
                            
                        

                        <span class="date middot" title='Mon May 21 2018 14:15:00 UTC'>
                            2018-05-21
                        </span>

                        <span class="reading-time middot">
                            2 minute read
                        </span>

                        <div class="d-none d-md-inline tags">
                            <ul class="list-unstyled d-inline">
                                
                                    <li class="d-inline middot">
                                        <a href="https://nanx.me/tags/shiny">shiny</a>
                                    </li>
                                
                                    <li class="d-inline middot">
                                        <a href="https://nanx.me/tags/async">async</a>
                                    </li>
                                
                                    <li class="d-inline middot">
                                        <a href="https://nanx.me/tags/future">future</a>
                                    </li>
                                
                                    <li class="d-inline middot">
                                        <a href="https://nanx.me/tags/promises">promises</a>
                                    </li>
                                
                                    <li class="d-inline middot">
                                        <a href="https://nanx.me/tags/scalability">scalability</a>
                                    </li>
                                
                            </ul>
                        </div>

                        <div class="d-none d-md-inline tags">
                            <ul class="list-unstyled d-inline">
                                
                                
                            </ul>
                        </div>
                    </div>

                    <div class="markdown">
                        
    


<p>Shiny is my favorite web application framework. It is simply awesome. <a href="https://shiny.rstudio.com/reference/shiny/1.1.0/upgrade.html">Shiny 1.1.0</a> was released to CRAN last week. This update brings probably the most significant feature/improvement in recent years: async execution support. With the help of <a href="https://github.com/HenrikBengtsson/future">future</a>, <a href="https://github.com/rstudio/promises">promises</a> (computer science people surely knew how to name abstract things…), and this shiny update, you can now write scalable web applications using Shiny.</p>
<div class="text-center">
<div class="figure">
<img src="https://nanx.me/image/zootopia-flash.gif" alt="You Want It When? (Zootopia)" />
<p class="caption">You Want It When? (Zootopia)</p>
</div>
</div>
<p>In brief, if you have some long-running computations (such as querying a remote database, live fitting a statistical model) in your Shiny app, that computation would block additional users to use the app simultaneously, until that computation is finished. This is partially due to R’s single-threaded nature. Even if you could use multiple processes to serve a single app (such as using Shiny Server Pro or ShinyProxy), these <em>synchronous</em> executions will still severely limit the scalability of your app, since multiple users could still end up with using the same process when the number of concurrent users is significant.</p>
<p>By executing these computations <em>asynchronously</em>, you can avoid such issues as much as possible. Conceptually, this means running these time-consuming computations in separate R processes (which do not block new users), and handle the returned values automatically, no matter if they are successful or not. It sounds simple enough but could be complex to implement rigorously. Luckily, we don’t need to worry about the low-level details here. We only need to make two specific changes in the server logic to have such asynchronous executions (by using <code>future</code> and <code>promises</code>):</p>
<ol style="list-style-type: decimal">
<li>Wrap the long-running computation with <code>future()</code> or <code>future({})</code>;</li>
<li>After the <code>future</code> object, chain the following computations using the promises pipe operator <code>%...&gt;%</code> instead of the magrittr pipe operator <code>%&gt;%,</code> to get the object to render.</li>
</ol>
<p>In reality, it might be a bit more complicated than this, since you might want to modify some of your previous R code before you can chain them using the pipe operator, but in principle, this should work.</p>
<p>In summary, the new async execution support in Shiny could potentially help eliminate the previous performance bottlenecks and scale up some of your apps substantially, especially if you want to create enterprise-grade web applications. I would recommend watching Joe Cheng’s <a href="https://www.rstudio.com/resources/videos/scaling-shiny-apps-with-async-programming/">introductory talk video</a> to have a general idea and <a href="https://rstudio.github.io/promises/articles/shiny.html">this vignette</a> explaining the technical details on how to appropriately modify your app to achieve this.</p>



                    </div>

                    
                        <div class="navigation">
                            <div class="row">
                                <div class="col-12 col-md-6">
                                    
                                        <div class="mx-0 mx-md-4 mt-4 text-left">
                                            <a href="https://nanx.me/blog/post/https-censored-future/">« An HTTPS-Censored Future</a>
                                        </div>
                                    
                                </div>
                                <div class="col-12 col-md-6">
                                    
                                        <div class="mx-0 mx-md-4 mt-4 text-right">
                                            <a href="https://nanx.me/blog/post/learn-to-say-no-the-hard-way/">Learn to Say No The Hard Way »</a>
                                        </div>
                                    
                                </div>
                            </div>
                        </div>
                    
                </div>
            </div>
        </div>
    </div>

    <section id="comments">

      <div class="py-3 content">
            <div class="container">
                  <div class="row justify-content-center">
                        <div class="col-sm-12 col-md-10">
                              <div class="comments">
                                    <div id="disqus_thread"></div>
                              </div>
                        </div>
                  </div>
            </div>
      </div>

      <script type="text/javascript">
            (function () {
                  
                  
                  if (window.location.hostname == "localhost")
                        return;

                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  var disqus_shortname = 'nan-xiao-blog';
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
      </script>
      <noscript>
            Please enable JavaScript to view the
            <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
      </noscript>
</section>
    <div class="my-4 footer">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-sm-12 col-md-5">
                
                    <div class="mx-0 mx-md-4 text-left">
                        
                            <a href="https://nanx.me/">© 2019 Nan Xiao</a>
                        
                    </div>
                
            </div>
            <div class="col-sm-12 col-md-5">
                <div class="mx-0 mx-md-4 text-right">
                    
                        <a href="https://github.com/road2stat" target="_blank">
                            <img class="icon" src="https://nanx.me/img/github.svg" alt="GitHub" />
                        </a>
                    

                    

                    

                    
                    <a href="https://twitter.com/road2stat" target="_blank">
                        <img class="icon" src="https://nanx.me/img/twitter.svg" alt="Twitter" />
                    </a>
                    

                    
                    <a href="https://www.linkedin.com/in/road2stat" target="_blank">
                        <img class="icon" src="https://nanx.me/img/linkedin.svg" alt="LinkedIn" />
                    </a>
                    

                    

                    

                    

                    
                    <a href="mailto:me@nanx.me">
                        <img class="icon" src="https://nanx.me/img/email.svg" alt="Email" />
                    </a>
                    

                    
                        <a href="https://nanx.me/index.xml" class="mr-0">
                            <img class="icon" src="https://nanx.me/img/rss.svg" alt="RSS" />
                        </a>
                    

                    
                </div>
            </div>
        </div>
    </div>
</div>



    

    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js" integrity="sha256-sNPiigbfSkqUzMc5rgrdztLnneCMAp6W9wetJUZu9Zw=" crossorigin="anonymous"></script>
        
        <script>
            window.addEventListener('load', function() {
                hljs.initHighlighting();
            }, true);
        </script>
    

    

    
    
        

    
</body>

</html>
